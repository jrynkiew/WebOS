"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.SealedEnvelop = exports.Envelop = void 0;

var _action_pb = _interopRequireDefault(require("../../protogen/proto/types/action_pb"));

var _crypto = require("../crypto/crypto");

var _hash = require("../crypto/hash");

var _types = require("../rpc-method/types");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

class Envelop {
  // optional fields
  constructor(version, nonce, gasLimit, gasPrice) {
    _defineProperty(this, "version", void 0);

    _defineProperty(this, "nonce", void 0);

    _defineProperty(this, "gasLimit", void 0);

    _defineProperty(this, "gasPrice", void 0);

    _defineProperty(this, "transfer", void 0);

    _defineProperty(this, "execution", void 0);

    _defineProperty(this, "startSubChain", void 0);

    _defineProperty(this, "stopSubChain", void 0);

    _defineProperty(this, "putBlock", void 0);

    _defineProperty(this, "createDeposit", void 0);

    _defineProperty(this, "settleDeposit", void 0);

    _defineProperty(this, "createPlumChain", void 0);

    _defineProperty(this, "terminatePlumChain", void 0);

    _defineProperty(this, "plumPutBlock", void 0);

    _defineProperty(this, "plumCreateDeposit", void 0);

    _defineProperty(this, "plumStartExit", void 0);

    _defineProperty(this, "plumChallengeExit", void 0);

    _defineProperty(this, "plumResponseChallengeExit", void 0);

    _defineProperty(this, "plumFinalizeExit", void 0);

    _defineProperty(this, "plumSettleDeposit", void 0);

    _defineProperty(this, "plumTransfer", void 0);

    _defineProperty(this, "depositToRewardingFund", void 0);

    _defineProperty(this, "claimFromRewardingFund", void 0);

    _defineProperty(this, "grantReward", void 0);

    _defineProperty(this, "stakeCreate", void 0);

    _defineProperty(this, "stakeUnstake", void 0);

    _defineProperty(this, "stakeWithdraw", void 0);

    _defineProperty(this, "stakeAddDeposit", void 0);

    _defineProperty(this, "stakeRestake", void 0);

    _defineProperty(this, "stakeChangeCandidate", void 0);

    _defineProperty(this, "stakeTransferOwnership", void 0);

    _defineProperty(this, "candidateRegister", void 0);

    _defineProperty(this, "candidateUpdate", void 0);

    _defineProperty(this, "putPollResult", void 0);

    this.version = version;
    this.nonce = nonce;
    this.gasLimit = gasLimit;
    this.gasPrice = gasPrice;
  } // tslint:disable-next-line:cyclomatic-complexity


  core() {
    const gasLimit = this.gasLimit || "0";
    const gasPrice = this.gasPrice || "0";
    const pbActionCore = new _action_pb.default.ActionCore();
    pbActionCore.setVersion(this.version);
    pbActionCore.setNonce(Number(this.nonce));
    pbActionCore.setGaslimit(Number(gasLimit));
    pbActionCore.setGasprice(gasPrice);
    pbActionCore.setChainid(0); // oneof action

    if (this.transfer) {
      pbActionCore.setTransfer((0, _types.toActionTransfer)(this.transfer));
    } else if (this.execution) {
      pbActionCore.setExecution((0, _types.toActionExecution)(this.execution));
    } else if (this.startSubChain) {
      pbActionCore.setStartsubchain((0, _types.toActionStartSubChain)(this.startSubChain));
    } else if (this.stopSubChain) {
      pbActionCore.setStopsubchain((0, _types.toActionStopSubChain)(this.stopSubChain));
    } else if (this.putBlock) {
      pbActionCore.setPutblock((0, _types.toActionPutBlock)(this.putBlock));
    } else if (this.createDeposit) {
      pbActionCore.setCreatedeposit((0, _types.toActionCreateDeposit)(this.createDeposit));
    } else if (this.settleDeposit) {
      pbActionCore.setSettledeposit((0, _types.toActionSettleDeposit)(this.settleDeposit));
    } else if (this.createPlumChain) {
      pbActionCore.setCreateplumchain((0, _types.toActionCreatePlumChain)(this.createPlumChain));
    } else if (this.terminatePlumChain) {
      pbActionCore.setTerminateplumchain((0, _types.toActionTerminatePlumChain)(this.terminatePlumChain));
    } else if (this.plumPutBlock) {
      pbActionCore.setPlumputblock((0, _types.toActionPlumPutBlock)(this.plumPutBlock));
    } else if (this.plumCreateDeposit) {
      pbActionCore.setPlumcreatedeposit((0, _types.toActionPlumCreateDeposit)(this.plumCreateDeposit));
    } else if (this.plumStartExit) {
      pbActionCore.setPlumstartexit((0, _types.toActionPlumStartExit)(this.plumStartExit));
    } else if (this.plumChallengeExit) {
      pbActionCore.setPlumchallengeexit((0, _types.toActionPlumChallengeExit)(this.plumChallengeExit));
    } else if (this.plumResponseChallengeExit) {
      pbActionCore.setPlumresponsechallengeexit((0, _types.toActionPlumResponseChallengeExit)(this.plumResponseChallengeExit));
    } else if (this.plumFinalizeExit) {
      pbActionCore.setPlumfinalizeexit((0, _types.toActionPlumFinalizeExit)(this.plumFinalizeExit));
    } else if (this.plumSettleDeposit) {
      pbActionCore.setPlumsettledeposit((0, _types.toActionPlumSettleDeposit)(this.plumSettleDeposit));
    } else if (this.plumTransfer) {
      pbActionCore.setPlumtransfer((0, _types.toActionPlumTransfer)(this.plumTransfer));
    } else if (this.depositToRewardingFund) {
      pbActionCore.setDeposittorewardingfund((0, _types.toActionDepositToRewardingFund)(this.depositToRewardingFund));
    } else if (this.claimFromRewardingFund) {
      pbActionCore.setClaimfromrewardingfund((0, _types.toActionClaimFromRewardingFund)(this.claimFromRewardingFund));
    } else if (this.grantReward) {
      pbActionCore.setGrantreward((0, _types.toActionGrantReward)(this.grantReward));
    } else if (this.stakeCreate) {
      pbActionCore.setStakecreate((0, _types.toActionStakeCreate)(this.stakeCreate));
    } else if (this.stakeUnstake) {
      pbActionCore.setStakeunstake((0, _types.toActionStakeReclaim)(this.stakeUnstake));
    } else if (this.stakeWithdraw) {
      pbActionCore.setStakewithdraw((0, _types.toActionStakeReclaim)(this.stakeWithdraw));
    } else if (this.stakeAddDeposit) {
      pbActionCore.setStakeadddeposit((0, _types.toActionStakeAddDeposit)(this.stakeAddDeposit));
    } else if (this.stakeRestake) {
      pbActionCore.setStakerestake((0, _types.toActionStakeRestake)(this.stakeRestake));
    } else if (this.stakeChangeCandidate) {
      pbActionCore.setStakechangecandidate((0, _types.toActionStakeChangeCandidate)(this.stakeChangeCandidate));
    } else if (this.stakeTransferOwnership) {
      pbActionCore.setStaketransferownership((0, _types.toActionStakeTransferOwnership)(this.stakeTransferOwnership));
    } else if (this.candidateRegister) {
      pbActionCore.setCandidateregister((0, _types.toActionCandidateRegister)(this.candidateRegister));
    } else if (this.candidateUpdate) {
      pbActionCore.setCandidateupdate((0, _types.toActionCandidateBasicInfo)(this.candidateUpdate));
    }

    return pbActionCore;
  }

  bytestream() {
    return this.core().serializeBinary();
  }

  static deserialize(bytes) {
    const pbActionCore = _action_pb.default.ActionCore.deserializeBinary(bytes);

    const envelop = new Envelop(pbActionCore.getVersion(), String(pbActionCore.getNonce()), String(pbActionCore.getGaslimit()), pbActionCore.getGasprice());
    envelop.transfer = _types.GetActionsRequest.fromTransfer(pbActionCore.getTransfer());
    envelop.execution = _types.GetActionsRequest.fromExecution(pbActionCore.getExecution());
    envelop.claimFromRewardingFund = _types.GetActionsRequest.fromClaimFromRewardingFund(pbActionCore.getClaimfromrewardingfund());
    envelop.stakeCreate = _types.GetActionsRequest.fromStakeCreate(pbActionCore.getStakecreate());
    envelop.stakeUnstake = _types.GetActionsRequest.fromStakeReclaim(pbActionCore.getStakeunstake());
    envelop.stakeWithdraw = _types.GetActionsRequest.fromStakeReclaim(pbActionCore.getStakewithdraw());
    envelop.stakeAddDeposit = _types.GetActionsRequest.fromStakeAddDeposit(pbActionCore.getStakeadddeposit());
    envelop.stakeRestake = _types.GetActionsRequest.fromStakeRestake(pbActionCore.getStakerestake());
    envelop.stakeChangeCandidate = _types.GetActionsRequest.fromStakeChangeCandidate(pbActionCore.getStakechangecandidate());
    envelop.stakeTransferOwnership = _types.GetActionsRequest.fromStakeTransferOwnership(pbActionCore.getStaketransferownership());
    envelop.candidateRegister = _types.GetActionsRequest.fromCandidateRegister(pbActionCore.getCandidateregister());
    envelop.candidateUpdate = _types.GetActionsRequest.fromCandidateUpdate(pbActionCore.getCandidateupdate()); // TODO(tian): add more fields

    return envelop;
  }

}

exports.Envelop = Envelop;

class SealedEnvelop {
  constructor(act, senderPubKey, signature) {
    _defineProperty(this, "act", void 0);

    _defineProperty(this, "senderPubKey", void 0);

    _defineProperty(this, "signature", void 0);

    this.act = act;
    this.senderPubKey = senderPubKey;
    this.signature = signature;
  }

  bytestream() {
    const pbActionCore = this.act.core();
    const pbAction = new _action_pb.default.Action();
    pbAction.setCore(pbActionCore);
    pbAction.setSenderpubkey(this.senderPubKey);
    pbAction.setSignature(this.signature);
    pbAction.setEncoding(0);
    return pbAction.serializeBinary();
  }

  hash() {
    return Buffer.from((0, _hash.hash256b)(this.bytestream())).toString("hex");
  }

  action() {
    const gasLimit = this.act.gasLimit || "0";
    const gasPrice = this.act.gasPrice || "0";
    return {
      core: {
        version: this.act.version,
        nonce: this.act.nonce,
        gasLimit: gasLimit,
        gasPrice: gasPrice,
        chainID: 0,
        transfer: this.act.transfer,
        execution: this.act.execution,
        startSubChain: this.act.startSubChain,
        stopSubChain: this.act.stopSubChain,
        putBlock: this.act.putBlock,
        createDeposit: this.act.createDeposit,
        settleDeposit: this.act.settleDeposit,
        createPlumChain: this.act.createPlumChain,
        terminatePlumChain: this.act.terminatePlumChain,
        plumPutBlock: this.act.plumPutBlock,
        plumCreateDeposit: this.act.plumCreateDeposit,
        plumStartExit: this.act.plumStartExit,
        plumChallengeExit: this.act.plumChallengeExit,
        plumResponseChallengeExit: this.act.plumResponseChallengeExit,
        plumFinalizeExit: this.act.plumFinalizeExit,
        plumSettleDeposit: this.act.plumSettleDeposit,
        plumTransfer: this.act.plumTransfer,
        depositToRewardingFund: this.act.depositToRewardingFund,
        claimFromRewardingFund: this.act.claimFromRewardingFund,
        grantReward: this.act.grantReward,
        stakeCreate: this.act.stakeCreate,
        stakeUnstake: this.act.stakeUnstake,
        stakeWithdraw: this.act.stakeWithdraw,
        stakeAddDeposit: this.act.stakeAddDeposit,
        stakeRestake: this.act.stakeRestake,
        stakeChangeCandidate: this.act.stakeChangeCandidate,
        stakeTransferOwnership: this.act.stakeTransferOwnership,
        candidateRegister: this.act.candidateRegister,
        candidateUpdate: this.act.candidateUpdate,
        putPollResult: this.act.putPollResult
      },
      senderPubKey: this.senderPubKey,
      signature: this.signature,
      encoding: 0
    };
  }

  static sign(privateKey, publicKey, act) {
    const h = (0, _hash.hash256b)(act.bytestream());
    const sign = Buffer.from((0, _crypto.makeSigner)(0)(h.toString("hex"), privateKey), "hex");
    return new SealedEnvelop(act, Buffer.from(publicKey, "hex"), sign);
  }

}

exports.SealedEnvelop = SealedEnvelop;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hY3Rpb24vZW52ZWxvcC50cyJdLCJuYW1lcyI6WyJFbnZlbG9wIiwiY29uc3RydWN0b3IiLCJ2ZXJzaW9uIiwibm9uY2UiLCJnYXNMaW1pdCIsImdhc1ByaWNlIiwiY29yZSIsInBiQWN0aW9uQ29yZSIsImFjdGlvblBiIiwiQWN0aW9uQ29yZSIsInNldFZlcnNpb24iLCJzZXROb25jZSIsIk51bWJlciIsInNldEdhc2xpbWl0Iiwic2V0R2FzcHJpY2UiLCJzZXRDaGFpbmlkIiwidHJhbnNmZXIiLCJzZXRUcmFuc2ZlciIsImV4ZWN1dGlvbiIsInNldEV4ZWN1dGlvbiIsInN0YXJ0U3ViQ2hhaW4iLCJzZXRTdGFydHN1YmNoYWluIiwic3RvcFN1YkNoYWluIiwic2V0U3RvcHN1YmNoYWluIiwicHV0QmxvY2siLCJzZXRQdXRibG9jayIsImNyZWF0ZURlcG9zaXQiLCJzZXRDcmVhdGVkZXBvc2l0Iiwic2V0dGxlRGVwb3NpdCIsInNldFNldHRsZWRlcG9zaXQiLCJjcmVhdGVQbHVtQ2hhaW4iLCJzZXRDcmVhdGVwbHVtY2hhaW4iLCJ0ZXJtaW5hdGVQbHVtQ2hhaW4iLCJzZXRUZXJtaW5hdGVwbHVtY2hhaW4iLCJwbHVtUHV0QmxvY2siLCJzZXRQbHVtcHV0YmxvY2siLCJwbHVtQ3JlYXRlRGVwb3NpdCIsInNldFBsdW1jcmVhdGVkZXBvc2l0IiwicGx1bVN0YXJ0RXhpdCIsInNldFBsdW1zdGFydGV4aXQiLCJwbHVtQ2hhbGxlbmdlRXhpdCIsInNldFBsdW1jaGFsbGVuZ2VleGl0IiwicGx1bVJlc3BvbnNlQ2hhbGxlbmdlRXhpdCIsInNldFBsdW1yZXNwb25zZWNoYWxsZW5nZWV4aXQiLCJwbHVtRmluYWxpemVFeGl0Iiwic2V0UGx1bWZpbmFsaXplZXhpdCIsInBsdW1TZXR0bGVEZXBvc2l0Iiwic2V0UGx1bXNldHRsZWRlcG9zaXQiLCJwbHVtVHJhbnNmZXIiLCJzZXRQbHVtdHJhbnNmZXIiLCJkZXBvc2l0VG9SZXdhcmRpbmdGdW5kIiwic2V0RGVwb3NpdHRvcmV3YXJkaW5nZnVuZCIsImNsYWltRnJvbVJld2FyZGluZ0Z1bmQiLCJzZXRDbGFpbWZyb21yZXdhcmRpbmdmdW5kIiwiZ3JhbnRSZXdhcmQiLCJzZXRHcmFudHJld2FyZCIsInN0YWtlQ3JlYXRlIiwic2V0U3Rha2VjcmVhdGUiLCJzdGFrZVVuc3Rha2UiLCJzZXRTdGFrZXVuc3Rha2UiLCJzdGFrZVdpdGhkcmF3Iiwic2V0U3Rha2V3aXRoZHJhdyIsInN0YWtlQWRkRGVwb3NpdCIsInNldFN0YWtlYWRkZGVwb3NpdCIsInN0YWtlUmVzdGFrZSIsInNldFN0YWtlcmVzdGFrZSIsInN0YWtlQ2hhbmdlQ2FuZGlkYXRlIiwic2V0U3Rha2VjaGFuZ2VjYW5kaWRhdGUiLCJzdGFrZVRyYW5zZmVyT3duZXJzaGlwIiwic2V0U3Rha2V0cmFuc2Zlcm93bmVyc2hpcCIsImNhbmRpZGF0ZVJlZ2lzdGVyIiwic2V0Q2FuZGlkYXRlcmVnaXN0ZXIiLCJjYW5kaWRhdGVVcGRhdGUiLCJzZXRDYW5kaWRhdGV1cGRhdGUiLCJieXRlc3RyZWFtIiwic2VyaWFsaXplQmluYXJ5IiwiZGVzZXJpYWxpemUiLCJieXRlcyIsImRlc2VyaWFsaXplQmluYXJ5IiwiZW52ZWxvcCIsImdldFZlcnNpb24iLCJTdHJpbmciLCJnZXROb25jZSIsImdldEdhc2xpbWl0IiwiZ2V0R2FzcHJpY2UiLCJHZXRBY3Rpb25zUmVxdWVzdCIsImZyb21UcmFuc2ZlciIsImdldFRyYW5zZmVyIiwiZnJvbUV4ZWN1dGlvbiIsImdldEV4ZWN1dGlvbiIsImZyb21DbGFpbUZyb21SZXdhcmRpbmdGdW5kIiwiZ2V0Q2xhaW1mcm9tcmV3YXJkaW5nZnVuZCIsImZyb21TdGFrZUNyZWF0ZSIsImdldFN0YWtlY3JlYXRlIiwiZnJvbVN0YWtlUmVjbGFpbSIsImdldFN0YWtldW5zdGFrZSIsImdldFN0YWtld2l0aGRyYXciLCJmcm9tU3Rha2VBZGREZXBvc2l0IiwiZ2V0U3Rha2VhZGRkZXBvc2l0IiwiZnJvbVN0YWtlUmVzdGFrZSIsImdldFN0YWtlcmVzdGFrZSIsImZyb21TdGFrZUNoYW5nZUNhbmRpZGF0ZSIsImdldFN0YWtlY2hhbmdlY2FuZGlkYXRlIiwiZnJvbVN0YWtlVHJhbnNmZXJPd25lcnNoaXAiLCJnZXRTdGFrZXRyYW5zZmVyb3duZXJzaGlwIiwiZnJvbUNhbmRpZGF0ZVJlZ2lzdGVyIiwiZ2V0Q2FuZGlkYXRlcmVnaXN0ZXIiLCJmcm9tQ2FuZGlkYXRlVXBkYXRlIiwiZ2V0Q2FuZGlkYXRldXBkYXRlIiwiU2VhbGVkRW52ZWxvcCIsImFjdCIsInNlbmRlclB1YktleSIsInNpZ25hdHVyZSIsInBiQWN0aW9uIiwiQWN0aW9uIiwic2V0Q29yZSIsInNldFNlbmRlcnB1YmtleSIsInNldFNpZ25hdHVyZSIsInNldEVuY29kaW5nIiwiaGFzaCIsIkJ1ZmZlciIsImZyb20iLCJ0b1N0cmluZyIsImFjdGlvbiIsImNoYWluSUQiLCJwdXRQb2xsUmVzdWx0IiwiZW5jb2RpbmciLCJzaWduIiwicHJpdmF0ZUtleSIsInB1YmxpY0tleSIsImgiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7O0FBOERPLE1BQU1BLE9BQU4sQ0FBYztBQU1uQjtBQWdDQUMsRUFBQUEsV0FBVyxDQUNUQyxPQURTLEVBRVRDLEtBRlMsRUFHVEMsUUFIUyxFQUlUQyxRQUpTLEVBS1Q7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFDQSxTQUFLSCxPQUFMLEdBQWVBLE9BQWY7QUFDQSxTQUFLQyxLQUFMLEdBQWFBLEtBQWI7QUFDQSxTQUFLQyxRQUFMLEdBQWdCQSxRQUFoQjtBQUNBLFNB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S0FBS3dDLEdBQUwsQ0FBU3hDLGlCQWpDeEI7QUFrQ0pFLFFBQUFBLGVBQWUsRUFBRSxLQUFLc0MsR0FBTCxDQUFTdEMsZUFsQ3RCO0FBbUNKcUQsUUFBQUEsYUFBYSxFQUFFLEtBQUtmLEdBQUwsQ0FBU2U7QUFuQ3BCLE9BREQ7QUFzQ0xkLE1BQUFBLFlBQVksRUFBRSxLQUFLQSxZQXRDZDtBQXVDTEMsTUFBQUEsU0FBUyxFQUFFLEtBQUtBLFNBdkNYO0FBd0NMYyxNQUFBQSxRQUFRLEVBQUU7QUF4Q0wsS0FBUDtBQTBDRDs7QUFFaUIsU0FBSkMsSUFBSSxDQUNoQkMsVUFEZ0IsRUFFaEJDLFNBRmdCLEVBR2hCbkIsR0FIZ0IsRUFJRDtBQUNmLFVBQU1vQixDQUFDLEdBQUcsb0JBQVNwQixHQUFHLENBQUNwQyxVQUFKLEVBQVQsQ0FBVjtBQUNBLFVBQU1xRCxJQUFJLEdBQUdQLE1BQU0sQ0FBQ0MsSUFBUCxDQUNYLHdCQUFXLENBQVgsRUFBY1MsQ0FBQyxDQUFDUixRQUFGLENBQVcsS0FBWCxDQUFkLEVBQWlDTSxVQUFqQyxDQURXLEVBRVgsS0FGVyxDQUFiO0FBSUEsV0FBTyxJQUFJbkIsYUFBSixDQUFrQkMsR0FBbEIsRUFBdUJVLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZUSxTQUFaLEVBQXVCLEtBQXZCLENBQXZCLEVBQXNERixJQUF0RCxDQUFQO0FBQ0Q7O0FBcEZ3QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBhY3Rpb25QYiBmcm9tIFwiLi4vLi4vcHJvdG9nZW4vcHJvdG8vdHlwZXMvYWN0aW9uX3BiXCI7XG5pbXBvcnQgeyBtYWtlU2lnbmVyIH0gZnJvbSBcIi4uL2NyeXB0by9jcnlwdG9cIjtcbmltcG9ydCB7IGhhc2gyNTZiIH0gZnJvbSBcIi4uL2NyeXB0by9oYXNoXCI7XG5pbXBvcnQge1xuICBHZXRBY3Rpb25zUmVxdWVzdCxcbiAgSUFjdGlvbixcbiAgSUNhbmRpZGF0ZUJhc2ljSW5mbyxcbiAgSUNhbmRpZGF0ZVJlZ2lzdGVyLFxuICBJQ2xhaW1Gcm9tUmV3YXJkaW5nRnVuZCxcbiAgSUNyZWF0ZURlcG9zaXQsXG4gIElDcmVhdGVQbHVtQ2hhaW4sXG4gIElEZXBvc2l0VG9SZXdhcmRpbmdGdW5kLFxuICBJRXhlY3V0aW9uLFxuICBJR3JhbnRSZXdhcmQsXG4gIElQbHVtQ2hhbGxlbmdlRXhpdCxcbiAgSVBsdW1DcmVhdGVEZXBvc2l0LFxuICBJUGx1bUZpbmFsaXplRXhpdCxcbiAgSVBsdW1QdXRCbG9jayxcbiAgSVBsdW1SZXNwb25zZUNoYWxsZW5nZUV4aXQsXG4gIElQbHVtU2V0dGxlRGVwb3NpdCxcbiAgSVBsdW1TdGFydEV4aXQsXG4gIElQbHVtVHJhbnNmZXIsXG4gIElQdXRCbG9jayxcbiAgSVB1dFBvbGxSZXN1bHQsXG4gIElTZXR0bGVEZXBvc2l0LFxuICBJU3Rha2VBZGREZXBvc2l0LFxuICBJU3Rha2VDaGFuZ2VDYW5kaWRhdGUsXG4gIElTdGFrZUNyZWF0ZSxcbiAgSVN0YWtlUmVjbGFpbSxcbiAgSVN0YWtlUmVzdGFrZSxcbiAgSVN0YWtlVHJhbnNmZXJPd25lcnNoaXAsXG4gIElTdGFydFN1YkNoYWluLFxuICBJU3RvcFN1YkNoYWluLFxuICBJVGVybWluYXRlUGx1bUNoYWluLFxuICBJVHJhbnNmZXIsXG4gIHRvQWN0aW9uQ2FuZGlkYXRlQmFzaWNJbmZvLFxuICB0b0FjdGlvbkNhbmRpZGF0ZVJlZ2lzdGVyLFxuICB0b0FjdGlvbkNsYWltRnJvbVJld2FyZGluZ0Z1bmQsXG4gIHRvQWN0aW9uQ3JlYXRlRGVwb3NpdCxcbiAgdG9BY3Rpb25DcmVhdGVQbHVtQ2hhaW4sXG4gIHRvQWN0aW9uRGVwb3NpdFRvUmV3YXJkaW5nRnVuZCxcbiAgdG9BY3Rpb25FeGVjdXRpb24sXG4gIHRvQWN0aW9uR3JhbnRSZXdhcmQsXG4gIHRvQWN0aW9uUGx1bUNoYWxsZW5nZUV4aXQsXG4gIHRvQWN0aW9uUGx1bUNyZWF0ZURlcG9zaXQsXG4gIHRvQWN0aW9uUGx1bUZpbmFsaXplRXhpdCxcbiAgdG9BY3Rpb25QbHVtUHV0QmxvY2ssXG4gIHRvQWN0aW9uUGx1bVJlc3BvbnNlQ2hhbGxlbmdlRXhpdCxcbiAgdG9BY3Rpb25QbHVtU2V0dGxlRGVwb3NpdCxcbiAgdG9BY3Rpb25QbHVtU3RhcnRFeGl0LFxuICB0b0FjdGlvblBsdW1UcmFuc2ZlcixcbiAgdG9BY3Rpb25QdXRCbG9jayxcbiAgdG9BY3Rpb25TZXR0bGVEZXBvc2l0LFxuICB0b0FjdGlvblN0YWtlQWRkRGVwb3NpdCxcbiAgdG9BY3Rpb25TdGFrZUNoYW5nZUNhbmRpZGF0ZSxcbiAgdG9BY3Rpb25TdGFrZUNyZWF0ZSxcbiAgdG9BY3Rpb25TdGFrZVJlY2xhaW0sXG4gIHRvQWN0aW9uU3Rha2VSZXN0YWtlLFxuICB0b0FjdGlvblN0YWtlVHJhbnNmZXJPd25lcnNoaXAsXG4gIHRvQWN0aW9uU3RhcnRTdWJDaGFpbixcbiAgdG9BY3Rpb25TdG9wU3ViQ2hhaW4sXG4gIHRvQWN0aW9uVGVybWluYXRlUGx1bUNoYWluLFxuICB0b0FjdGlvblRyYW5zZmVyXG59IGZyb20gXCIuLi9ycGMtbWV0aG9kL3R5cGVzXCI7XG5cbmV4cG9ydCBjbGFzcyBFbnZlbG9wIHtcbiAgcHVibGljIHZlcnNpb246IG51bWJlcjtcbiAgcHVibGljIG5vbmNlOiBzdHJpbmc7XG4gIHB1YmxpYyBnYXNMaW1pdD86IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgcHVibGljIGdhc1ByaWNlPzogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gIC8vIG9wdGlvbmFsIGZpZWxkc1xuICBwdWJsaWMgdHJhbnNmZXI/OiBJVHJhbnNmZXIgfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBleGVjdXRpb24/OiBJRXhlY3V0aW9uIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc3RhcnRTdWJDaGFpbj86IElTdGFydFN1YkNoYWluIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc3RvcFN1YkNoYWluPzogSVN0b3BTdWJDaGFpbiB8IHVuZGVmaW5lZDtcbiAgcHVibGljIHB1dEJsb2NrPzogSVB1dEJsb2NrIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgY3JlYXRlRGVwb3NpdD86IElDcmVhdGVEZXBvc2l0IHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc2V0dGxlRGVwb3NpdD86IElTZXR0bGVEZXBvc2l0IHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgY3JlYXRlUGx1bUNoYWluPzogSUNyZWF0ZVBsdW1DaGFpbiB8IHVuZGVmaW5lZDtcbiAgcHVibGljIHRlcm1pbmF0ZVBsdW1DaGFpbj86IElUZXJtaW5hdGVQbHVtQ2hhaW4gfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBwbHVtUHV0QmxvY2s/OiBJUGx1bVB1dEJsb2NrIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgcGx1bUNyZWF0ZURlcG9zaXQ/OiBJUGx1bUNyZWF0ZURlcG9zaXQgfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBwbHVtU3RhcnRFeGl0PzogSVBsdW1TdGFydEV4aXQgfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBwbHVtQ2hhbGxlbmdlRXhpdD86IElQbHVtQ2hhbGxlbmdlRXhpdCB8IHVuZGVmaW5lZDtcbiAgcHVibGljIHBsdW1SZXNwb25zZUNoYWxsZW5nZUV4aXQ/OiBJUGx1bVJlc3BvbnNlQ2hhbGxlbmdlRXhpdCB8IHVuZGVmaW5lZDtcbiAgcHVibGljIHBsdW1GaW5hbGl6ZUV4aXQ/OiBJUGx1bUZpbmFsaXplRXhpdCB8IHVuZGVmaW5lZDtcbiAgcHVibGljIHBsdW1TZXR0bGVEZXBvc2l0PzogSVBsdW1TZXR0bGVEZXBvc2l0IHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgcGx1bVRyYW5zZmVyPzogSVBsdW1UcmFuc2ZlciB8IHVuZGVmaW5lZDtcbiAgcHVibGljIGRlcG9zaXRUb1Jld2FyZGluZ0Z1bmQ/OiBJRGVwb3NpdFRvUmV3YXJkaW5nRnVuZCB8IHVuZGVmaW5lZDtcbiAgcHVibGljIGNsYWltRnJvbVJld2FyZGluZ0Z1bmQ/OiBJQ2xhaW1Gcm9tUmV3YXJkaW5nRnVuZCB8IHVuZGVmaW5lZDtcbiAgcHVibGljIGdyYW50UmV3YXJkPzogSUdyYW50UmV3YXJkIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc3Rha2VDcmVhdGU/OiBJU3Rha2VDcmVhdGUgfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBzdGFrZVVuc3Rha2U/OiBJU3Rha2VSZWNsYWltIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc3Rha2VXaXRoZHJhdz86IElTdGFrZVJlY2xhaW0gfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBzdGFrZUFkZERlcG9zaXQ/OiBJU3Rha2VBZGREZXBvc2l0IHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc3Rha2VSZXN0YWtlPzogSVN0YWtlUmVzdGFrZSB8IHVuZGVmaW5lZDtcbiAgcHVibGljIHN0YWtlQ2hhbmdlQ2FuZGlkYXRlPzogSVN0YWtlQ2hhbmdlQ2FuZGlkYXRlIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc3Rha2VUcmFuc2Zlck93bmVyc2hpcD86IElTdGFrZVRyYW5zZmVyT3duZXJzaGlwIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgY2FuZGlkYXRlUmVnaXN0ZXI/OiBJQ2FuZGlkYXRlUmVnaXN0ZXIgfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBjYW5kaWRhdGVVcGRhdGU/OiBJQ2FuZGlkYXRlQmFzaWNJbmZvIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgcHV0UG9sbFJlc3VsdD86IElQdXRQb2xsUmVzdWx0IHwgdW5kZWZpbmVkO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHZlcnNpb246IG51bWJlcixcbiAgICBub25jZTogc3RyaW5nLFxuICAgIGdhc0xpbWl0Pzogc3RyaW5nLFxuICAgIGdhc1ByaWNlPzogc3RyaW5nXG4gICkge1xuICAgIHRoaXMudmVyc2lvbiA9IHZlcnNpb247XG4gICAgdGhpcy5ub25jZSA9IG5vbmNlO1xuICAgIHRoaXMuZ2FzTGltaXQgPSBnYXNMaW1pdDtcbiAgICB0aGlzLmdhc1ByaWNlID0gZ2FzUHJpY2U7XG4gIH1cblxuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y3ljbG9tYXRpYy1jb21wbGV4aXR5XG4gIHB1YmxpYyBjb3JlKCk6IGFjdGlvblBiLkFjdGlvbkNvcmUge1xuICAgIGNvbnN0IGdhc0xpbWl0ID0gdGhpcy5nYXNMaW1pdCB8fCBcIjBcIjtcbiAgICBjb25zdCBnYXNQcmljZSA9IHRoaXMuZ2FzUHJpY2UgfHwgXCIwXCI7XG5cbiAgICBjb25zdCBwYkFjdGlvbkNvcmUgPSBuZXcgYWN0aW9uUGIuQWN0aW9uQ29yZSgpO1xuICAgIHBiQWN0aW9uQ29yZS5zZXRWZXJzaW9uKHRoaXMudmVyc2lvbik7XG4gICAgcGJBY3Rpb25Db3JlLnNldE5vbmNlKE51bWJlcih0aGlzLm5vbmNlKSk7XG4gICAgcGJBY3Rpb25Db3JlLnNldEdhc2xpbWl0KE51bWJlcihnYXNMaW1pdCkpO1xuICAgIHBiQWN0aW9uQ29yZS5zZXRHYXNwcmljZShnYXNQcmljZSk7XG4gICAgcGJBY3Rpb25Db3JlLnNldENoYWluaWQoMCk7XG5cbiAgICAvLyBvbmVvZiBhY3Rpb25cbiAgICBpZiAodGhpcy50cmFuc2Zlcikge1xuICAgICAgcGJBY3Rpb25Db3JlLnNldFRyYW5zZmVyKHRvQWN0aW9uVHJhbnNmZXIodGhpcy50cmFuc2ZlcikpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5leGVjdXRpb24pIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRFeGVjdXRpb24odG9BY3Rpb25FeGVjdXRpb24odGhpcy5leGVjdXRpb24pKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhcnRTdWJDaGFpbikge1xuICAgICAgcGJBY3Rpb25Db3JlLnNldFN0YXJ0c3ViY2hhaW4odG9BY3Rpb25TdGFydFN1YkNoYWluKHRoaXMuc3RhcnRTdWJDaGFpbikpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5zdG9wU3ViQ2hhaW4pIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRTdG9wc3ViY2hhaW4odG9BY3Rpb25TdG9wU3ViQ2hhaW4odGhpcy5zdG9wU3ViQ2hhaW4pKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucHV0QmxvY2spIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRQdXRibG9jayh0b0FjdGlvblB1dEJsb2NrKHRoaXMucHV0QmxvY2spKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuY3JlYXRlRGVwb3NpdCkge1xuICAgICAgcGJBY3Rpb25Db3JlLnNldENyZWF0ZWRlcG9zaXQodG9BY3Rpb25DcmVhdGVEZXBvc2l0KHRoaXMuY3JlYXRlRGVwb3NpdCkpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5zZXR0bGVEZXBvc2l0KSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0U2V0dGxlZGVwb3NpdCh0b0FjdGlvblNldHRsZURlcG9zaXQodGhpcy5zZXR0bGVEZXBvc2l0KSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNyZWF0ZVBsdW1DaGFpbikge1xuICAgICAgcGJBY3Rpb25Db3JlLnNldENyZWF0ZXBsdW1jaGFpbihcbiAgICAgICAgdG9BY3Rpb25DcmVhdGVQbHVtQ2hhaW4odGhpcy5jcmVhdGVQbHVtQ2hhaW4pXG4gICAgICApO1xuICAgIH0gZWxzZSBpZiAodGhpcy50ZXJtaW5hdGVQbHVtQ2hhaW4pIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRUZXJtaW5hdGVwbHVtY2hhaW4oXG4gICAgICAgIHRvQWN0aW9uVGVybWluYXRlUGx1bUNoYWluKHRoaXMudGVybWluYXRlUGx1bUNoYWluKVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucGx1bVB1dEJsb2NrKSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0UGx1bXB1dGJsb2NrKHRvQWN0aW9uUGx1bVB1dEJsb2NrKHRoaXMucGx1bVB1dEJsb2NrKSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnBsdW1DcmVhdGVEZXBvc2l0KSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0UGx1bWNyZWF0ZWRlcG9zaXQoXG4gICAgICAgIHRvQWN0aW9uUGx1bUNyZWF0ZURlcG9zaXQodGhpcy5wbHVtQ3JlYXRlRGVwb3NpdClcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnBsdW1TdGFydEV4aXQpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRQbHVtc3RhcnRleGl0KHRvQWN0aW9uUGx1bVN0YXJ0RXhpdCh0aGlzLnBsdW1TdGFydEV4aXQpKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucGx1bUNoYWxsZW5nZUV4aXQpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRQbHVtY2hhbGxlbmdlZXhpdChcbiAgICAgICAgdG9BY3Rpb25QbHVtQ2hhbGxlbmdlRXhpdCh0aGlzLnBsdW1DaGFsbGVuZ2VFeGl0KVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucGx1bVJlc3BvbnNlQ2hhbGxlbmdlRXhpdCkge1xuICAgICAgcGJBY3Rpb25Db3JlLnNldFBsdW1yZXNwb25zZWNoYWxsZW5nZWV4aXQoXG4gICAgICAgIHRvQWN0aW9uUGx1bVJlc3BvbnNlQ2hhbGxlbmdlRXhpdCh0aGlzLnBsdW1SZXNwb25zZUNoYWxsZW5nZUV4aXQpXG4gICAgICApO1xuICAgIH0gZWxzZSBpZiAodGhpcy5wbHVtRmluYWxpemVFeGl0KSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0UGx1bWZpbmFsaXplZXhpdChcbiAgICAgICAgdG9BY3Rpb25QbHVtRmluYWxpemVFeGl0KHRoaXMucGx1bUZpbmFsaXplRXhpdClcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnBsdW1TZXR0bGVEZXBvc2l0KSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0UGx1bXNldHRsZWRlcG9zaXQoXG4gICAgICAgIHRvQWN0aW9uUGx1bVNldHRsZURlcG9zaXQodGhpcy5wbHVtU2V0dGxlRGVwb3NpdClcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnBsdW1UcmFuc2Zlcikge1xuICAgICAgcGJBY3Rpb25Db3JlLnNldFBsdW10cmFuc2Zlcih0b0FjdGlvblBsdW1UcmFuc2Zlcih0aGlzLnBsdW1UcmFuc2ZlcikpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5kZXBvc2l0VG9SZXdhcmRpbmdGdW5kKSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0RGVwb3NpdHRvcmV3YXJkaW5nZnVuZChcbiAgICAgICAgdG9BY3Rpb25EZXBvc2l0VG9SZXdhcmRpbmdGdW5kKHRoaXMuZGVwb3NpdFRvUmV3YXJkaW5nRnVuZClcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNsYWltRnJvbVJld2FyZGluZ0Z1bmQpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRDbGFpbWZyb21yZXdhcmRpbmdmdW5kKFxuICAgICAgICB0b0FjdGlvbkNsYWltRnJvbVJld2FyZGluZ0Z1bmQodGhpcy5jbGFpbUZyb21SZXdhcmRpbmdGdW5kKVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuZ3JhbnRSZXdhcmQpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRHcmFudHJld2FyZCh0b0FjdGlvbkdyYW50UmV3YXJkKHRoaXMuZ3JhbnRSZXdhcmQpKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3Rha2VDcmVhdGUpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRTdGFrZWNyZWF0ZSh0b0FjdGlvblN0YWtlQ3JlYXRlKHRoaXMuc3Rha2VDcmVhdGUpKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3Rha2VVbnN0YWtlKSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0U3Rha2V1bnN0YWtlKHRvQWN0aW9uU3Rha2VSZWNsYWltKHRoaXMuc3Rha2VVbnN0YWtlKSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnN0YWtlV2l0aGRyYXcpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRTdGFrZXdpdGhkcmF3KHRvQWN0aW9uU3Rha2VSZWNsYWltKHRoaXMuc3Rha2VXaXRoZHJhdykpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5zdGFrZUFkZERlcG9zaXQpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRTdGFrZWFkZGRlcG9zaXQoXG4gICAgICAgIHRvQWN0aW9uU3Rha2VBZGREZXBvc2l0KHRoaXMuc3Rha2VBZGREZXBvc2l0KVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3Rha2VSZXN0YWtlKSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0U3Rha2VyZXN0YWtlKHRvQWN0aW9uU3Rha2VSZXN0YWtlKHRoaXMuc3Rha2VSZXN0YWtlKSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnN0YWtlQ2hhbmdlQ2FuZGlkYXRlKSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0U3Rha2VjaGFuZ2VjYW5kaWRhdGUoXG4gICAgICAgIHRvQWN0aW9uU3Rha2VDaGFuZ2VDYW5kaWRhdGUodGhpcy5zdGFrZUNoYW5nZUNhbmRpZGF0ZSlcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnN0YWtlVHJhbnNmZXJPd25lcnNoaXApIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRTdGFrZXRyYW5zZmVyb3duZXJzaGlwKFxuICAgICAgICB0b0FjdGlvblN0YWtlVHJhbnNmZXJPd25lcnNoaXAodGhpcy5zdGFrZVRyYW5zZmVyT3duZXJzaGlwKVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuY2FuZGlkYXRlUmVnaXN0ZXIpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRDYW5kaWRhdGVyZWdpc3RlcihcbiAgICAgICAgdG9BY3Rpb25DYW5kaWRhdGVSZWdpc3Rlcih0aGlzLmNhbmRpZGF0ZVJlZ2lzdGVyKVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuY2FuZGlkYXRlVXBkYXRlKSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0Q2FuZGlkYXRldXBkYXRlKFxuICAgICAgICB0b0FjdGlvbkNhbmRpZGF0ZUJhc2ljSW5mbyh0aGlzLmNhbmRpZGF0ZVVwZGF0ZSlcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBwYkFjdGlvbkNvcmU7XG4gIH1cblxuICBwdWJsaWMgYnl0ZXN0cmVhbSgpOiBVaW50OEFycmF5IHtcbiAgICByZXR1cm4gdGhpcy5jb3JlKCkuc2VyaWFsaXplQmluYXJ5KCk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGRlc2VyaWFsaXplKGJ5dGVzOiBVaW50OEFycmF5KTogRW52ZWxvcCB7XG4gICAgY29uc3QgcGJBY3Rpb25Db3JlID0gYWN0aW9uUGIuQWN0aW9uQ29yZS5kZXNlcmlhbGl6ZUJpbmFyeShieXRlcyk7XG4gICAgY29uc3QgZW52ZWxvcCA9IG5ldyBFbnZlbG9wKFxuICAgICAgcGJBY3Rpb25Db3JlLmdldFZlcnNpb24oKSxcbiAgICAgIFN0cmluZyhwYkFjdGlvbkNvcmUuZ2V0Tm9uY2UoKSksXG4gICAgICBTdHJpbmcocGJBY3Rpb25Db3JlLmdldEdhc2xpbWl0KCkpLFxuICAgICAgcGJBY3Rpb25Db3JlLmdldEdhc3ByaWNlKClcbiAgICApO1xuICAgIGVudmVsb3AudHJhbnNmZXIgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tVHJhbnNmZXIoXG4gICAgICBwYkFjdGlvbkNvcmUuZ2V0VHJhbnNmZXIoKVxuICAgICk7XG4gICAgZW52ZWxvcC5leGVjdXRpb24gPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tRXhlY3V0aW9uKFxuICAgICAgcGJBY3Rpb25Db3JlLmdldEV4ZWN1dGlvbigpXG4gICAgKTtcbiAgICBlbnZlbG9wLmNsYWltRnJvbVJld2FyZGluZ0Z1bmQgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tQ2xhaW1Gcm9tUmV3YXJkaW5nRnVuZChcbiAgICAgIHBiQWN0aW9uQ29yZS5nZXRDbGFpbWZyb21yZXdhcmRpbmdmdW5kKClcbiAgICApO1xuICAgIGVudmVsb3Auc3Rha2VDcmVhdGUgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tU3Rha2VDcmVhdGUoXG4gICAgICBwYkFjdGlvbkNvcmUuZ2V0U3Rha2VjcmVhdGUoKVxuICAgICk7XG4gICAgZW52ZWxvcC5zdGFrZVVuc3Rha2UgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tU3Rha2VSZWNsYWltKFxuICAgICAgcGJBY3Rpb25Db3JlLmdldFN0YWtldW5zdGFrZSgpXG4gICAgKTtcbiAgICBlbnZlbG9wLnN0YWtlV2l0aGRyYXcgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tU3Rha2VSZWNsYWltKFxuICAgICAgcGJBY3Rpb25Db3JlLmdldFN0YWtld2l0aGRyYXcoKVxuICAgICk7XG4gICAgZW52ZWxvcC5zdGFrZUFkZERlcG9zaXQgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tU3Rha2VBZGREZXBvc2l0KFxuICAgICAgcGJBY3Rpb25Db3JlLmdldFN0YWtlYWRkZGVwb3NpdCgpXG4gICAgKTtcbiAgICBlbnZlbG9wLnN0YWtlUmVzdGFrZSA9IEdldEFjdGlvbnNSZXF1ZXN0LmZyb21TdGFrZVJlc3Rha2UoXG4gICAgICBwYkFjdGlvbkNvcmUuZ2V0U3Rha2VyZXN0YWtlKClcbiAgICApO1xuICAgIGVudmVsb3Auc3Rha2VDaGFuZ2VDYW5kaWRhdGUgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tU3Rha2VDaGFuZ2VDYW5kaWRhdGUoXG4gICAgICBwYkFjdGlvbkNvcmUuZ2V0U3Rha2VjaGFuZ2VjYW5kaWRhdGUoKVxuICAgICk7XG4gICAgZW52ZWxvcC5zdGFrZVRyYW5zZmVyT3duZXJzaGlwID0gR2V0QWN0aW9uc1JlcXVlc3QuZnJvbVN0YWtlVHJhbnNmZXJPd25lcnNoaXAoXG4gICAgICBwYkFjdGlvbkNvcmUuZ2V0U3Rha2V0cmFuc2Zlcm93bmVyc2hpcCgpXG4gICAgKTtcbiAgICBlbnZlbG9wLmNhbmRpZGF0ZVJlZ2lzdGVyID0gR2V0QWN0aW9uc1JlcXVlc3QuZnJvbUNhbmRpZGF0ZVJlZ2lzdGVyKFxuICAgICAgcGJBY3Rpb25Db3JlLmdldENhbmRpZGF0ZXJlZ2lzdGVyKClcbiAgICApO1xuICAgIGVudmVsb3AuY2FuZGlkYXRlVXBkYXRlID0gR2V0QWN0aW9uc1JlcXVlc3QuZnJvbUNhbmRpZGF0ZVVwZGF0ZShcbiAgICAgIHBiQWN0aW9uQ29yZS5nZXRDYW5kaWRhdGV1cGRhdGUoKVxuICAgICk7XG4gICAgLy8gVE9ETyh0aWFuKTogYWRkIG1vcmUgZmllbGRzXG4gICAgcmV0dXJuIGVudmVsb3A7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFNlYWxlZEVudmVsb3Age1xuICBwdWJsaWMgYWN0OiBFbnZlbG9wO1xuICBwdWJsaWMgc2VuZGVyUHViS2V5OiBCdWZmZXI7XG4gIHB1YmxpYyBzaWduYXR1cmU6IEJ1ZmZlcjtcblxuICBjb25zdHJ1Y3RvcihhY3Q6IEVudmVsb3AsIHNlbmRlclB1YktleTogQnVmZmVyLCBzaWduYXR1cmU6IEJ1ZmZlcikge1xuICAgIHRoaXMuYWN0ID0gYWN0O1xuICAgIHRoaXMuc2VuZGVyUHViS2V5ID0gc2VuZGVyUHViS2V5O1xuICAgIHRoaXMuc2lnbmF0dXJlID0gc2lnbmF0dXJlO1xuICB9XG5cbiAgcHVibGljIGJ5dGVzdHJlYW0oKTogVWludDhBcnJheSB7XG4gICAgY29uc3QgcGJBY3Rpb25Db3JlID0gdGhpcy5hY3QuY29yZSgpO1xuICAgIGNvbnN0IHBiQWN0aW9uID0gbmV3IGFjdGlvblBiLkFjdGlvbigpO1xuICAgIHBiQWN0aW9uLnNldENvcmUocGJBY3Rpb25Db3JlKTtcbiAgICBwYkFjdGlvbi5zZXRTZW5kZXJwdWJrZXkodGhpcy5zZW5kZXJQdWJLZXkpO1xuICAgIHBiQWN0aW9uLnNldFNpZ25hdHVyZSh0aGlzLnNpZ25hdHVyZSk7XG4gICAgcGJBY3Rpb24uc2V0RW5jb2RpbmcoMCk7XG4gICAgcmV0dXJuIHBiQWN0aW9uLnNlcmlhbGl6ZUJpbmFyeSgpO1xuICB9XG5cbiAgcHVibGljIGhhc2goKTogc3RyaW5nIHtcbiAgICByZXR1cm4gQnVmZmVyLmZyb20oaGFzaDI1NmIodGhpcy5ieXRlc3RyZWFtKCkpKS50b1N0cmluZyhcImhleFwiKTtcbiAgfVxuXG4gIHB1YmxpYyBhY3Rpb24oKTogSUFjdGlvbiB7XG4gICAgY29uc3QgZ2FzTGltaXQgPSB0aGlzLmFjdC5nYXNMaW1pdCB8fCBcIjBcIjtcbiAgICBjb25zdCBnYXNQcmljZSA9IHRoaXMuYWN0Lmdhc1ByaWNlIHx8IFwiMFwiO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGNvcmU6IHtcbiAgICAgICAgdmVyc2lvbjogdGhpcy5hY3QudmVyc2lvbixcbiAgICAgICAgbm9uY2U6IHRoaXMuYWN0Lm5vbmNlLFxuICAgICAgICBnYXNMaW1pdDogZ2FzTGltaXQsXG4gICAgICAgIGdhc1ByaWNlOiBnYXNQcmljZSxcbiAgICAgICAgY2hhaW5JRDogMCxcbiAgICAgICAgdHJhbnNmZXI6IHRoaXMuYWN0LnRyYW5zZmVyLFxuICAgICAgICBleGVjdXRpb246IHRoaXMuYWN0LmV4ZWN1dGlvbixcbiAgICAgICAgc3RhcnRTdWJDaGFpbjogdGhpcy5hY3Quc3RhcnRTdWJDaGFpbixcbiAgICAgICAgc3RvcFN1YkNoYWluOiB0aGlzLmFjdC5zdG9wU3ViQ2hhaW4sXG4gICAgICAgIHB1dEJsb2NrOiB0aGlzLmFjdC5wdXRCbG9jayxcbiAgICAgICAgY3JlYXRlRGVwb3NpdDogdGhpcy5hY3QuY3JlYXRlRGVwb3NpdCxcbiAgICAgICAgc2V0dGxlRGVwb3NpdDogdGhpcy5hY3Quc2V0dGxlRGVwb3NpdCxcbiAgICAgICAgY3JlYXRlUGx1bUNoYWluOiB0aGlzLmFjdC5jcmVhdGVQbHVtQ2hhaW4sXG4gICAgICAgIHRlcm1pbmF0ZVBsdW1DaGFpbjogdGhpcy5hY3QudGVybWluYXRlUGx1bUNoYWluLFxuICAgICAgICBwbHVtUHV0QmxvY2s6IHRoaXMuYWN0LnBsdW1QdXRCbG9jayxcbiAgICAgICAgcGx1bUNyZWF0ZURlcG9zaXQ6IHRoaXMuYWN0LnBsdW1DcmVhdGVEZXBvc2l0LFxuICAgICAgICBwbHVtU3RhcnRFeGl0OiB0aGlzLmFjdC5wbHVtU3RhcnRFeGl0LFxuICAgICAgICBwbHVtQ2hhbGxlbmdlRXhpdDogdGhpcy5hY3QucGx1bUNoYWxsZW5nZUV4aXQsXG4gICAgICAgIHBsdW1SZXNwb25zZUNoYWxsZW5nZUV4aXQ6IHRoaXMuYWN0LnBsdW1SZXNwb25zZUNoYWxsZW5nZUV4aXQsXG4gICAgICAgIHBsdW1GaW5hbGl6ZUV4aXQ6IHRoaXMuYWN0LnBsdW1GaW5hbGl6ZUV4aXQsXG4gICAgICAgIHBsdW1TZXR0bGVEZXBvc2l0OiB0aGlzLmFjdC5wbHVtU2V0dGxlRGVwb3NpdCxcbiAgICAgICAgcGx1bVRyYW5zZmVyOiB0aGlzLmFjdC5wbHVtVHJhbnNmZXIsXG4gICAgICAgIGRlcG9zaXRUb1Jld2FyZGluZ0Z1bmQ6IHRoaXMuYWN0LmRlcG9zaXRUb1Jld2FyZGluZ0Z1bmQsXG4gICAgICAgIGNsYWltRnJvbVJld2FyZGluZ0Z1bmQ6IHRoaXMuYWN0LmNsYWltRnJvbVJld2FyZGluZ0Z1bmQsXG4gICAgICAgIGdyYW50UmV3YXJkOiB0aGlzLmFjdC5ncmFudFJld2FyZCxcbiAgICAgICAgc3Rha2VDcmVhdGU6IHRoaXMuYWN0LnN0YWtlQ3JlYXRlLFxuICAgICAgICBzdGFrZVVuc3Rha2U6IHRoaXMuYWN0LnN0YWtlVW5zdGFrZSxcbiAgICAgICAgc3Rha2VXaXRoZHJhdzogdGhpcy5hY3Quc3Rha2VXaXRoZHJhdyxcbiAgICAgICAgc3Rha2VBZGREZXBvc2l0OiB0aGlzLmFjdC5zdGFrZUFkZERlcG9zaXQsXG4gICAgICAgIHN0YWtlUmVzdGFrZTogdGhpcy5hY3Quc3Rha2VSZXN0YWtlLFxuICAgICAgICBzdGFrZUNoYW5nZUNhbmRpZGF0ZTogdGhpcy5hY3Quc3Rha2VDaGFuZ2VDYW5kaWRhdGUsXG4gICAgICAgIHN0YWtlVHJhbnNmZXJPd25lcnNoaXA6IHRoaXMuYWN0LnN0YWtlVHJhbnNmZXJPd25lcnNoaXAsXG4gICAgICAgIGNhbmRpZGF0ZVJlZ2lzdGVyOiB0aGlzLmFjdC5jYW5kaWRhdGVSZWdpc3RlcixcbiAgICAgICAgY2FuZGlkYXRlVXBkYXRlOiB0aGlzLmFjdC5jYW5kaWRhdGVVcGRhdGUsXG4gICAgICAgIHB1dFBvbGxSZXN1bHQ6IHRoaXMuYWN0LnB1dFBvbGxSZXN1bHRcbiAgICAgIH0sXG4gICAgICBzZW5kZXJQdWJLZXk6IHRoaXMuc2VuZGVyUHViS2V5LFxuICAgICAgc2lnbmF0dXJlOiB0aGlzLnNpZ25hdHVyZSxcbiAgICAgIGVuY29kaW5nOiAwXG4gICAgfTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgc2lnbihcbiAgICBwcml2YXRlS2V5OiBzdHJpbmcsXG4gICAgcHVibGljS2V5OiBzdHJpbmcsXG4gICAgYWN0OiBFbnZlbG9wXG4gICk6IFNlYWxlZEVudmVsb3Age1xuICAgIGNvbnN0IGggPSBoYXNoMjU2YihhY3QuYnl0ZXN0cmVhbSgpKTtcbiAgICBjb25zdCBzaWduID0gQnVmZmVyLmZyb20oXG4gICAgICBtYWtlU2lnbmVyKDApKGgudG9TdHJpbmcoXCJoZXhcIiksIHByaXZhdGVLZXkpLFxuICAgICAgXCJoZXhcIlxuICAgICk7XG4gICAgcmV0dXJuIG5ldyBTZWFsZWRFbnZlbG9wKGFjdCwgQnVmZmVyLmZyb20ocHVibGljS2V5LCBcImhleFwiKSwgc2lnbik7XG4gIH1cbn1cbiJdfQ==