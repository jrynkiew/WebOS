"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.SealedEnvelop = exports.Envelop = void 0;

var _action_pb = _interopRequireDefault(require("../../protogen/proto/types/action_pb"));

var _crypto = require("../crypto/crypto");

var _hash = require("../crypto/hash");

var _types = require("../rpc-method/types");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

class Envelop {
  // optional fields
  constructor(version, nonce, gasLimit, gasPrice) {
    _defineProperty(this, "version", void 0);

    _defineProperty(this, "nonce", void 0);

    _defineProperty(this, "gasLimit", void 0);

    _defineProperty(this, "gasPrice", void 0);

    _defineProperty(this, "transfer", void 0);

    _defineProperty(this, "execution", void 0);

    _defineProperty(this, "startSubChain", void 0);

    _defineProperty(this, "stopSubChain", void 0);

    _defineProperty(this, "putBlock", void 0);

    _defineProperty(this, "createDeposit", void 0);

    _defineProperty(this, "settleDeposit", void 0);

    _defineProperty(this, "createPlumChain", void 0);

    _defineProperty(this, "terminatePlumChain", void 0);

    _defineProperty(this, "plumPutBlock", void 0);

    _defineProperty(this, "plumCreateDeposit", void 0);

    _defineProperty(this, "plumStartExit", void 0);

    _defineProperty(this, "plumChallengeExit", void 0);

    _defineProperty(this, "plumResponseChallengeExit", void 0);

    _defineProperty(this, "plumFinalizeExit", void 0);

    _defineProperty(this, "plumSettleDeposit", void 0);

    _defineProperty(this, "plumTransfer", void 0);

    _defineProperty(this, "depositToRewardingFund", void 0);

    _defineProperty(this, "claimFromRewardingFund", void 0);

    _defineProperty(this, "grantReward", void 0);

    _defineProperty(this, "stakeCreate", void 0);

    _defineProperty(this, "stakeUnstake", void 0);

    _defineProperty(this, "stakeWithdraw", void 0);

    _defineProperty(this, "stakeAddDeposit", void 0);

    _defineProperty(this, "stakeRestake", void 0);

    _defineProperty(this, "stakeChangeCandidate", void 0);

    _defineProperty(this, "stakeTransferOwnership", void 0);

    _defineProperty(this, "candidateRegister", void 0);

    _defineProperty(this, "candidateUpdate", void 0);

    _defineProperty(this, "putPollResult", void 0);

    this.version = version;
    this.nonce = nonce;
    this.gasLimit = gasLimit;
    this.gasPrice = gasPrice;
  } // tslint:disable-next-line:cyclomatic-complexity


  core() {
    const gasLimit = this.gasLimit || "0";
    const gasPrice = this.gasPrice || "0";
    const pbActionCore = new _action_pb.default.ActionCore();
    pbActionCore.setVersion(this.version);
    pbActionCore.setNonce(Number(this.nonce));
    pbActionCore.setGaslimit(Number(gasLimit));
    pbActionCore.setGasprice(gasPrice); // oneof action

    if (this.transfer) {
      pbActionCore.setTransfer((0, _types.toActionTransfer)(this.transfer));
    } else if (this.execution) {
      pbActionCore.setExecution((0, _types.toActionExecution)(this.execution));
    } else if (this.startSubChain) {
      pbActionCore.setStartsubchain((0, _types.toActionStartSubChain)(this.startSubChain));
    } else if (this.stopSubChain) {
      pbActionCore.setStopsubchain((0, _types.toActionStopSubChain)(this.stopSubChain));
    } else if (this.putBlock) {
      pbActionCore.setPutblock((0, _types.toActionPutBlock)(this.putBlock));
    } else if (this.createDeposit) {
      pbActionCore.setCreatedeposit((0, _types.toActionCreateDeposit)(this.createDeposit));
    } else if (this.settleDeposit) {
      pbActionCore.setSettledeposit((0, _types.toActionSettleDeposit)(this.settleDeposit));
    } else if (this.createPlumChain) {
      pbActionCore.setCreateplumchain((0, _types.toActionCreatePlumChain)(this.createPlumChain));
    } else if (this.terminatePlumChain) {
      pbActionCore.setTerminateplumchain((0, _types.toActionTerminatePlumChain)(this.terminatePlumChain));
    } else if (this.plumPutBlock) {
      pbActionCore.setPlumputblock((0, _types.toActionPlumPutBlock)(this.plumPutBlock));
    } else if (this.plumCreateDeposit) {
      pbActionCore.setPlumcreatedeposit((0, _types.toActionPlumCreateDeposit)(this.plumCreateDeposit));
    } else if (this.plumStartExit) {
      pbActionCore.setPlumstartexit((0, _types.toActionPlumStartExit)(this.plumStartExit));
    } else if (this.plumChallengeExit) {
      pbActionCore.setPlumchallengeexit((0, _types.toActionPlumChallengeExit)(this.plumChallengeExit));
    } else if (this.plumResponseChallengeExit) {
      pbActionCore.setPlumresponsechallengeexit((0, _types.toActionPlumResponseChallengeExit)(this.plumResponseChallengeExit));
    } else if (this.plumFinalizeExit) {
      pbActionCore.setPlumfinalizeexit((0, _types.toActionPlumFinalizeExit)(this.plumFinalizeExit));
    } else if (this.plumSettleDeposit) {
      pbActionCore.setPlumsettledeposit((0, _types.toActionPlumSettleDeposit)(this.plumSettleDeposit));
    } else if (this.plumTransfer) {
      pbActionCore.setPlumtransfer((0, _types.toActionPlumTransfer)(this.plumTransfer));
    } else if (this.depositToRewardingFund) {
      pbActionCore.setDeposittorewardingfund((0, _types.toActionDepositToRewardingFund)(this.depositToRewardingFund));
    } else if (this.claimFromRewardingFund) {
      pbActionCore.setClaimfromrewardingfund((0, _types.toActionClaimFromRewardingFund)(this.claimFromRewardingFund));
    } else if (this.grantReward) {
      pbActionCore.setGrantreward((0, _types.toActionGrantReward)(this.grantReward));
    } else if (this.stakeCreate) {
      pbActionCore.setStakecreate((0, _types.toActionStakeCreate)(this.stakeCreate));
    } else if (this.stakeUnstake) {
      pbActionCore.setStakeunstake((0, _types.toActionStakeReclaim)(this.stakeUnstake));
    } else if (this.stakeWithdraw) {
      pbActionCore.setStakewithdraw((0, _types.toActionStakeReclaim)(this.stakeWithdraw));
    } else if (this.stakeAddDeposit) {
      pbActionCore.setStakeadddeposit((0, _types.toActionStakeAddDeposit)(this.stakeAddDeposit));
    } else if (this.stakeRestake) {
      pbActionCore.setStakerestake((0, _types.toActionStakeRestake)(this.stakeRestake));
    } else if (this.stakeChangeCandidate) {
      pbActionCore.setStakechangecandidate((0, _types.toActionStakeChangeCandidate)(this.stakeChangeCandidate));
    } else if (this.stakeTransferOwnership) {
      pbActionCore.setStaketransferownership((0, _types.toActionStakeTransferOwnership)(this.stakeTransferOwnership));
    } else if (this.candidateRegister) {
      pbActionCore.setCandidateregister((0, _types.toActionCandidateRegister)(this.candidateRegister));
    } else if (this.candidateUpdate) {
      pbActionCore.setCandidateupdate((0, _types.toActionCandidateBasicInfo)(this.candidateUpdate));
    }

    return pbActionCore;
  }

  bytestream() {
    return this.core().serializeBinary();
  }

  static deserialize(bytes) {
    const pbActionCore = _action_pb.default.ActionCore.deserializeBinary(bytes);

    const envelop = new Envelop(pbActionCore.getVersion(), String(pbActionCore.getNonce()), String(pbActionCore.getGaslimit()), pbActionCore.getGasprice());
    envelop.transfer = _types.GetActionsRequest.fromTransfer(pbActionCore.getTransfer());
    envelop.execution = _types.GetActionsRequest.fromExecution(pbActionCore.getExecution());
    envelop.claimFromRewardingFund = _types.GetActionsRequest.fromClaimFromRewardingFund(pbActionCore.getClaimfromrewardingfund());
    envelop.stakeCreate = _types.GetActionsRequest.fromStakeCreate(pbActionCore.getStakecreate());
    envelop.stakeUnstake = _types.GetActionsRequest.fromStakeReclaim(pbActionCore.getStakeunstake());
    envelop.stakeWithdraw = _types.GetActionsRequest.fromStakeReclaim(pbActionCore.getStakewithdraw());
    envelop.stakeAddDeposit = _types.GetActionsRequest.fromStakeAddDeposit(pbActionCore.getStakeadddeposit());
    envelop.stakeRestake = _types.GetActionsRequest.fromStakeRestake(pbActionCore.getStakerestake());
    envelop.stakeChangeCandidate = _types.GetActionsRequest.fromStakeChangeCandidate(pbActionCore.getStakechangecandidate());
    envelop.stakeTransferOwnership = _types.GetActionsRequest.fromStakeTransferOwnership(pbActionCore.getStaketransferownership());
    envelop.candidateRegister = _types.GetActionsRequest.fromCandidateRegister(pbActionCore.getCandidateregister());
    envelop.candidateUpdate = _types.GetActionsRequest.fromCandidateUpdate(pbActionCore.getCandidateupdate()); // TODO(tian): add more fields

    return envelop;
  }

}

exports.Envelop = Envelop;

class SealedEnvelop {
  constructor(act, senderPubKey, signature) {
    _defineProperty(this, "act", void 0);

    _defineProperty(this, "senderPubKey", void 0);

    _defineProperty(this, "signature", void 0);

    this.act = act;
    this.senderPubKey = senderPubKey;
    this.signature = signature;
  }

  bytestream() {
    const pbActionCore = this.act.core();
    const pbAction = new _action_pb.default.Action();
    pbAction.setCore(pbActionCore);
    pbAction.setSenderpubkey(this.senderPubKey);
    pbAction.setSignature(this.signature);
    return pbAction.serializeBinary();
  }

  hash() {
    return Buffer.from((0, _hash.hash256b)(this.bytestream())).toString("hex");
  }

  action() {
    const gasLimit = this.act.gasLimit || "0";
    const gasPrice = this.act.gasPrice || "0";
    return {
      core: {
        version: this.act.version,
        nonce: this.act.nonce,
        gasLimit: gasLimit,
        gasPrice: gasPrice,
        transfer: this.act.transfer,
        execution: this.act.execution,
        startSubChain: this.act.startSubChain,
        stopSubChain: this.act.stopSubChain,
        putBlock: this.act.putBlock,
        createDeposit: this.act.createDeposit,
        settleDeposit: this.act.settleDeposit,
        createPlumChain: this.act.createPlumChain,
        terminatePlumChain: this.act.terminatePlumChain,
        plumPutBlock: this.act.plumPutBlock,
        plumCreateDeposit: this.act.plumCreateDeposit,
        plumStartExit: this.act.plumStartExit,
        plumChallengeExit: this.act.plumChallengeExit,
        plumResponseChallengeExit: this.act.plumResponseChallengeExit,
        plumFinalizeExit: this.act.plumFinalizeExit,
        plumSettleDeposit: this.act.plumSettleDeposit,
        plumTransfer: this.act.plumTransfer,
        depositToRewardingFund: this.act.depositToRewardingFund,
        claimFromRewardingFund: this.act.claimFromRewardingFund,
        grantReward: this.act.grantReward,
        stakeCreate: this.act.stakeCreate,
        stakeUnstake: this.act.stakeUnstake,
        stakeWithdraw: this.act.stakeWithdraw,
        stakeAddDeposit: this.act.stakeAddDeposit,
        stakeRestake: this.act.stakeRestake,
        stakeChangeCandidate: this.act.stakeChangeCandidate,
        stakeTransferOwnership: this.act.stakeTransferOwnership,
        candidateRegister: this.act.candidateRegister,
        candidateUpdate: this.act.candidateUpdate,
        putPollResult: this.act.putPollResult
      },
      senderPubKey: this.senderPubKey,
      signature: this.signature
    };
  }

  static sign(privateKey, publicKey, act) {
    const h = (0, _hash.hash256b)(act.bytestream());
    const sign = Buffer.from((0, _crypto.makeSigner)(0)(h.toString("hex"), privateKey), "hex");
    return new SealedEnvelop(act, Buffer.from(publicKey, "hex"), sign);
  }

}

exports.SealedEnvelop = SealedEnvelop;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hY3Rpb24vZW52ZWxvcC50cyJdLCJuYW1lcyI6WyJFbnZlbG9wIiwiY29uc3RydWN0b3IiLCJ2ZXJzaW9uIiwibm9uY2UiLCJnYXNMaW1pdCIsImdhc1ByaWNlIiwiY29yZSIsInBiQWN0aW9uQ29yZSIsImFjdGlvblBiIiwiQWN0aW9uQ29yZSIsInNldFZlcnNpb24iLCJzZXROb25jZSIsIk51bWJlciIsInNldEdhc2xpbWl0Iiwic2V0R2FzcHJpY2UiLCJ0cmFuc2ZlciIsInNldFRyYW5zZmVyIiwiZXhlY3V0aW9uIiwic2V0RXhlY3V0aW9uIiwic3RhcnRTdWJDaGFpbiIsInNldFN0YXJ0c3ViY2hhaW4iLCJzdG9wU3ViQ2hhaW4iLCJzZXRTdG9wc3ViY2hhaW4iLCJwdXRCbG9jayIsInNldFB1dGJsb2NrIiwiY3JlYXRlRGVwb3NpdCIsInNldENyZWF0ZWRlcG9zaXQiLCJzZXR0bGVEZXBvc2l0Iiwic2V0U2V0dGxlZGVwb3NpdCIsImNyZWF0ZVBsdW1DaGFpbiIsInNldENyZWF0ZXBsdW1jaGFpbiIsInRlcm1pbmF0ZVBsdW1DaGFpbiIsInNldFRlcm1pbmF0ZXBsdW1jaGFpbiIsInBsdW1QdXRCbG9jayIsInNldFBsdW1wdXRibG9jayIsInBsdW1DcmVhdGVEZXBvc2l0Iiwic2V0UGx1bWNyZWF0ZWRlcG9zaXQiLCJwbHVtU3RhcnRFeGl0Iiwic2V0UGx1bXN0YXJ0ZXhpdCIsInBsdW1DaGFsbGVuZ2VFeGl0Iiwic2V0UGx1bWNoYWxsZW5nZWV4aXQiLCJwbHVtUmVzcG9uc2VDaGFsbGVuZ2VFeGl0Iiwic2V0UGx1bXJlc3BvbnNlY2hhbGxlbmdlZXhpdCIsInBsdW1GaW5hbGl6ZUV4aXQiLCJzZXRQbHVtZmluYWxpemVleGl0IiwicGx1bVNldHRsZURlcG9zaXQiLCJzZXRQbHVtc2V0dGxlZGVwb3NpdCIsInBsdW1UcmFuc2ZlciIsInNldFBsdW10cmFuc2ZlciIsImRlcG9zaXRUb1Jld2FyZGluZ0Z1bmQiLCJzZXREZXBvc2l0dG9yZXdhcmRpbmdmdW5kIiwiY2xhaW1Gcm9tUmV3YXJkaW5nRnVuZCIsInNldENsYWltZnJvbXJld2FyZGluZ2Z1bmQiLCJncmFudFJld2FyZCIsInNldEdyYW50cmV3YXJkIiwic3Rha2VDcmVhdGUiLCJzZXRTdGFrZWNyZWF0ZSIsInN0YWtlVW5zdGFrZSIsInNldFN0YWtldW5zdGFrZSIsInN0YWtlV2l0aGRyYXciLCJzZXRTdGFrZXdpdGhkcmF3Iiwic3Rha2VBZGREZXBvc2l0Iiwic2V0U3Rha2VhZGRkZXBvc2l0Iiwic3Rha2VSZXN0YWtlIiwic2V0U3Rha2VyZXN0YWtlIiwic3Rha2VDaGFuZ2VDYW5kaWRhdGUiLCJzZXRTdGFrZWNoYW5nZWNhbmRpZGF0ZSIsInN0YWtlVHJhbnNmZXJPd25lcnNoaXAiLCJzZXRTdGFrZXRyYW5zZmVyb3duZXJzaGlwIiwiY2FuZGlkYXRlUmVnaXN0ZXIiLCJzZXRDYW5kaWRhdGVyZWdpc3RlciIsImNhbmRpZGF0ZVVwZGF0ZSIsInNldENhbmRpZGF0ZXVwZGF0ZSIsImJ5dGVzdHJlYW0iLCJzZXJpYWxpemVCaW5hcnkiLCJkZXNlcmlhbGl6ZSIsImJ5dGVzIiwiZGVzZXJpYWxpemVCaW5hcnkiLCJlbnZlbG9wIiwiZ2V0VmVyc2lvbiIsIlN0cmluZyIsImdldE5vbmNlIiwiZ2V0R2FzbGltaXQiLCJnZXRHYXNwcmljZSIsIkdldEFjdGlvbnNSZXF1ZXN0IiwiZnJvbVRyYW5zZmVyIiwiZ2V0VHJhbnNmZXIiLCJmcm9tRXhlY3V0aW9uIiwiZ2V0RXhlY3V0aW9uIiwiZnJvbUNsYWltRnJvbVJld2FyZGluZ0Z1bmQiLCJnZXRDbGFpbWZyb21yZXdhcmRpbmdmdW5kIiwiZnJvbVN0YWtlQ3JlYXRlIiwiZ2V0U3Rha2VjcmVhdGUiLCJmcm9tU3Rha2VSZWNsYWltIiwiZ2V0U3Rha2V1bnN0YWtlIiwiZ2V0U3Rha2V3aXRoZHJhdyIsImZyb21TdGFrZUFkZERlcG9zaXQiLCJnZXRTdGFrZWFkZGRlcG9zaXQiLCJmcm9tU3Rha2VSZXN0YWtlIiwiZ2V0U3Rha2VyZXN0YWtlIiwiZnJvbVN0YWtlQ2hhbmdlQ2FuZGlkYXRlIiwiZ2V0U3Rha2VjaGFuZ2VjYW5kaWRhdGUiLCJmcm9tU3Rha2VUcmFuc2Zlck93bmVyc2hpcCIsImdldFN0YWtldHJhbnNmZXJvd25lcnNoaXAiLCJmcm9tQ2FuZGlkYXRlUmVnaXN0ZXIiLCJnZXRDYW5kaWRhdGVyZWdpc3RlciIsImZyb21DYW5kaWRhdGVVcGRhdGUiLCJnZXRDYW5kaWRhdGV1cGRhdGUiLCJTZWFsZWRFbnZlbG9wIiwiYWN0Iiwic2VuZGVyUHViS2V5Iiwic2lnbmF0dXJlIiwicGJBY3Rpb24iLCJBY3Rpb24iLCJzZXRDb3JlIiwic2V0U2VuZGVycHVia2V5Iiwic2V0U2lnbmF0dXJlIiwiaGFzaCIsIkJ1ZmZlciIsImZyb20iLCJ0b1N0cmluZyIsImFjdGlvbiIsInB1dFBvbGxSZXN1bHQiLCJzaWduIiwicHJpdmF0ZUtleSIsInB1YmxpY0tleSIsImgiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7O0FBOERPLE1BQU1BLE9BQU4sQ0FBYztBQU1uQjtBQWdDQUMsRUFBQUEsV0FBVyxDQUNUQyxPQURTLEVBRVRDLEtBRlMsRUFHVEMsUUFIUyxFQUlUQyxRQUpTLEVBS1Q7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFDQSxTQUFLSCxPQUFMLEdBQWVBLE9BQWY7QUFDQSxTQUFLQyxLQUFMLEdBQWFBLEtBQWI7QUFDQSxTQUFLQyxRQUFMLEdBQWdCQSxRQUFoQjtBQUNBLFNBQUtDLFFBQUwsR0FBZ0JBLFFBQWhCO0FBQ0QsR0FoRGtCLENBa0RuQjs7O0FBQ09D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ckNkO0FBc0NMQyxNQUFBQSxTQUFTLEVBQUUsS0FBS0E7QUF0Q1gsS0FBUDtBQXdDRDs7QUFFaUIsU0FBSlksSUFBSSxDQUNoQkMsVUFEZ0IsRUFFaEJDLFNBRmdCLEVBR2hCaEIsR0FIZ0IsRUFJRDtBQUNmLFVBQU1pQixDQUFDLEdBQUcsb0JBQVNqQixHQUFHLENBQUNwQyxVQUFKLEVBQVQsQ0FBVjtBQUNBLFVBQU1rRCxJQUFJLEdBQUdMLE1BQU0sQ0FBQ0MsSUFBUCxDQUNYLHdCQUFXLENBQVgsRUFBY08sQ0FBQyxDQUFDTixRQUFGLENBQVcsS0FBWCxDQUFkLEVBQWlDSSxVQUFqQyxDQURXLEVBRVgsS0FGVyxDQUFiO0FBSUEsV0FBTyxJQUFJaEIsYUFBSixDQUFrQkMsR0FBbEIsRUFBdUJTLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZTSxTQUFaLEVBQXVCLEtBQXZCLENBQXZCLEVBQXNERixJQUF0RCxDQUFQO0FBQ0Q7O0FBakZ3QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBhY3Rpb25QYiBmcm9tIFwiLi4vLi4vcHJvdG9nZW4vcHJvdG8vdHlwZXMvYWN0aW9uX3BiXCI7XG5pbXBvcnQgeyBtYWtlU2lnbmVyIH0gZnJvbSBcIi4uL2NyeXB0by9jcnlwdG9cIjtcbmltcG9ydCB7IGhhc2gyNTZiIH0gZnJvbSBcIi4uL2NyeXB0by9oYXNoXCI7XG5pbXBvcnQge1xuICBHZXRBY3Rpb25zUmVxdWVzdCxcbiAgSUFjdGlvbixcbiAgSUNhbmRpZGF0ZUJhc2ljSW5mbyxcbiAgSUNhbmRpZGF0ZVJlZ2lzdGVyLFxuICBJQ2xhaW1Gcm9tUmV3YXJkaW5nRnVuZCxcbiAgSUNyZWF0ZURlcG9zaXQsXG4gIElDcmVhdGVQbHVtQ2hhaW4sXG4gIElEZXBvc2l0VG9SZXdhcmRpbmdGdW5kLFxuICBJRXhlY3V0aW9uLFxuICBJR3JhbnRSZXdhcmQsXG4gIElQbHVtQ2hhbGxlbmdlRXhpdCxcbiAgSVBsdW1DcmVhdGVEZXBvc2l0LFxuICBJUGx1bUZpbmFsaXplRXhpdCxcbiAgSVBsdW1QdXRCbG9jayxcbiAgSVBsdW1SZXNwb25zZUNoYWxsZW5nZUV4aXQsXG4gIElQbHVtU2V0dGxlRGVwb3NpdCxcbiAgSVBsdW1TdGFydEV4aXQsXG4gIElQbHVtVHJhbnNmZXIsXG4gIElQdXRCbG9jayxcbiAgSVB1dFBvbGxSZXN1bHQsXG4gIElTZXR0bGVEZXBvc2l0LFxuICBJU3Rha2VBZGREZXBvc2l0LFxuICBJU3Rha2VDaGFuZ2VDYW5kaWRhdGUsXG4gIElTdGFrZUNyZWF0ZSxcbiAgSVN0YWtlUmVjbGFpbSxcbiAgSVN0YWtlUmVzdGFrZSxcbiAgSVN0YWtlVHJhbnNmZXJPd25lcnNoaXAsXG4gIElTdGFydFN1YkNoYWluLFxuICBJU3RvcFN1YkNoYWluLFxuICBJVGVybWluYXRlUGx1bUNoYWluLFxuICBJVHJhbnNmZXIsXG4gIHRvQWN0aW9uQ2FuZGlkYXRlQmFzaWNJbmZvLFxuICB0b0FjdGlvbkNhbmRpZGF0ZVJlZ2lzdGVyLFxuICB0b0FjdGlvbkNsYWltRnJvbVJld2FyZGluZ0Z1bmQsXG4gIHRvQWN0aW9uQ3JlYXRlRGVwb3NpdCxcbiAgdG9BY3Rpb25DcmVhdGVQbHVtQ2hhaW4sXG4gIHRvQWN0aW9uRGVwb3NpdFRvUmV3YXJkaW5nRnVuZCxcbiAgdG9BY3Rpb25FeGVjdXRpb24sXG4gIHRvQWN0aW9uR3JhbnRSZXdhcmQsXG4gIHRvQWN0aW9uUGx1bUNoYWxsZW5nZUV4aXQsXG4gIHRvQWN0aW9uUGx1bUNyZWF0ZURlcG9zaXQsXG4gIHRvQWN0aW9uUGx1bUZpbmFsaXplRXhpdCxcbiAgdG9BY3Rpb25QbHVtUHV0QmxvY2ssXG4gIHRvQWN0aW9uUGx1bVJlc3BvbnNlQ2hhbGxlbmdlRXhpdCxcbiAgdG9BY3Rpb25QbHVtU2V0dGxlRGVwb3NpdCxcbiAgdG9BY3Rpb25QbHVtU3RhcnRFeGl0LFxuICB0b0FjdGlvblBsdW1UcmFuc2ZlcixcbiAgdG9BY3Rpb25QdXRCbG9jayxcbiAgdG9BY3Rpb25TZXR0bGVEZXBvc2l0LFxuICB0b0FjdGlvblN0YWtlQWRkRGVwb3NpdCxcbiAgdG9BY3Rpb25TdGFrZUNoYW5nZUNhbmRpZGF0ZSxcbiAgdG9BY3Rpb25TdGFrZUNyZWF0ZSxcbiAgdG9BY3Rpb25TdGFrZVJlY2xhaW0sXG4gIHRvQWN0aW9uU3Rha2VSZXN0YWtlLFxuICB0b0FjdGlvblN0YWtlVHJhbnNmZXJPd25lcnNoaXAsXG4gIHRvQWN0aW9uU3RhcnRTdWJDaGFpbixcbiAgdG9BY3Rpb25TdG9wU3ViQ2hhaW4sXG4gIHRvQWN0aW9uVGVybWluYXRlUGx1bUNoYWluLFxuICB0b0FjdGlvblRyYW5zZmVyXG59IGZyb20gXCIuLi9ycGMtbWV0aG9kL3R5cGVzXCI7XG5cbmV4cG9ydCBjbGFzcyBFbnZlbG9wIHtcbiAgcHVibGljIHZlcnNpb246IG51bWJlcjtcbiAgcHVibGljIG5vbmNlOiBzdHJpbmc7XG4gIHB1YmxpYyBnYXNMaW1pdD86IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgcHVibGljIGdhc1ByaWNlPzogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gIC8vIG9wdGlvbmFsIGZpZWxkc1xuICBwdWJsaWMgdHJhbnNmZXI/OiBJVHJhbnNmZXIgfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBleGVjdXRpb24/OiBJRXhlY3V0aW9uIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc3RhcnRTdWJDaGFpbj86IElTdGFydFN1YkNoYWluIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc3RvcFN1YkNoYWluPzogSVN0b3BTdWJDaGFpbiB8IHVuZGVmaW5lZDtcbiAgcHVibGljIHB1dEJsb2NrPzogSVB1dEJsb2NrIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgY3JlYXRlRGVwb3NpdD86IElDcmVhdGVEZXBvc2l0IHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc2V0dGxlRGVwb3NpdD86IElTZXR0bGVEZXBvc2l0IHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgY3JlYXRlUGx1bUNoYWluPzogSUNyZWF0ZVBsdW1DaGFpbiB8IHVuZGVmaW5lZDtcbiAgcHVibGljIHRlcm1pbmF0ZVBsdW1DaGFpbj86IElUZXJtaW5hdGVQbHVtQ2hhaW4gfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBwbHVtUHV0QmxvY2s/OiBJUGx1bVB1dEJsb2NrIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgcGx1bUNyZWF0ZURlcG9zaXQ/OiBJUGx1bUNyZWF0ZURlcG9zaXQgfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBwbHVtU3RhcnRFeGl0PzogSVBsdW1TdGFydEV4aXQgfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBwbHVtQ2hhbGxlbmdlRXhpdD86IElQbHVtQ2hhbGxlbmdlRXhpdCB8IHVuZGVmaW5lZDtcbiAgcHVibGljIHBsdW1SZXNwb25zZUNoYWxsZW5nZUV4aXQ/OiBJUGx1bVJlc3BvbnNlQ2hhbGxlbmdlRXhpdCB8IHVuZGVmaW5lZDtcbiAgcHVibGljIHBsdW1GaW5hbGl6ZUV4aXQ/OiBJUGx1bUZpbmFsaXplRXhpdCB8IHVuZGVmaW5lZDtcbiAgcHVibGljIHBsdW1TZXR0bGVEZXBvc2l0PzogSVBsdW1TZXR0bGVEZXBvc2l0IHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgcGx1bVRyYW5zZmVyPzogSVBsdW1UcmFuc2ZlciB8IHVuZGVmaW5lZDtcbiAgcHVibGljIGRlcG9zaXRUb1Jld2FyZGluZ0Z1bmQ/OiBJRGVwb3NpdFRvUmV3YXJkaW5nRnVuZCB8IHVuZGVmaW5lZDtcbiAgcHVibGljIGNsYWltRnJvbVJld2FyZGluZ0Z1bmQ/OiBJQ2xhaW1Gcm9tUmV3YXJkaW5nRnVuZCB8IHVuZGVmaW5lZDtcbiAgcHVibGljIGdyYW50UmV3YXJkPzogSUdyYW50UmV3YXJkIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc3Rha2VDcmVhdGU/OiBJU3Rha2VDcmVhdGUgfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBzdGFrZVVuc3Rha2U/OiBJU3Rha2VSZWNsYWltIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc3Rha2VXaXRoZHJhdz86IElTdGFrZVJlY2xhaW0gfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBzdGFrZUFkZERlcG9zaXQ/OiBJU3Rha2VBZGREZXBvc2l0IHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc3Rha2VSZXN0YWtlPzogSVN0YWtlUmVzdGFrZSB8IHVuZGVmaW5lZDtcbiAgcHVibGljIHN0YWtlQ2hhbmdlQ2FuZGlkYXRlPzogSVN0YWtlQ2hhbmdlQ2FuZGlkYXRlIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgc3Rha2VUcmFuc2Zlck93bmVyc2hpcD86IElTdGFrZVRyYW5zZmVyT3duZXJzaGlwIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgY2FuZGlkYXRlUmVnaXN0ZXI/OiBJQ2FuZGlkYXRlUmVnaXN0ZXIgfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBjYW5kaWRhdGVVcGRhdGU/OiBJQ2FuZGlkYXRlQmFzaWNJbmZvIHwgdW5kZWZpbmVkO1xuICBwdWJsaWMgcHV0UG9sbFJlc3VsdD86IElQdXRQb2xsUmVzdWx0IHwgdW5kZWZpbmVkO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHZlcnNpb246IG51bWJlcixcbiAgICBub25jZTogc3RyaW5nLFxuICAgIGdhc0xpbWl0Pzogc3RyaW5nLFxuICAgIGdhc1ByaWNlPzogc3RyaW5nXG4gICkge1xuICAgIHRoaXMudmVyc2lvbiA9IHZlcnNpb247XG4gICAgdGhpcy5ub25jZSA9IG5vbmNlO1xuICAgIHRoaXMuZ2FzTGltaXQgPSBnYXNMaW1pdDtcbiAgICB0aGlzLmdhc1ByaWNlID0gZ2FzUHJpY2U7XG4gIH1cblxuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y3ljbG9tYXRpYy1jb21wbGV4aXR5XG4gIHB1YmxpYyBjb3JlKCk6IGFjdGlvblBiLkFjdGlvbkNvcmUge1xuICAgIGNvbnN0IGdhc0xpbWl0ID0gdGhpcy5nYXNMaW1pdCB8fCBcIjBcIjtcbiAgICBjb25zdCBnYXNQcmljZSA9IHRoaXMuZ2FzUHJpY2UgfHwgXCIwXCI7XG5cbiAgICBjb25zdCBwYkFjdGlvbkNvcmUgPSBuZXcgYWN0aW9uUGIuQWN0aW9uQ29yZSgpO1xuICAgIHBiQWN0aW9uQ29yZS5zZXRWZXJzaW9uKHRoaXMudmVyc2lvbik7XG4gICAgcGJBY3Rpb25Db3JlLnNldE5vbmNlKE51bWJlcih0aGlzLm5vbmNlKSk7XG4gICAgcGJBY3Rpb25Db3JlLnNldEdhc2xpbWl0KE51bWJlcihnYXNMaW1pdCkpO1xuICAgIHBiQWN0aW9uQ29yZS5zZXRHYXNwcmljZShnYXNQcmljZSk7XG5cbiAgICAvLyBvbmVvZiBhY3Rpb25cbiAgICBpZiAodGhpcy50cmFuc2Zlcikge1xuICAgICAgcGJBY3Rpb25Db3JlLnNldFRyYW5zZmVyKHRvQWN0aW9uVHJhbnNmZXIodGhpcy50cmFuc2ZlcikpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5leGVjdXRpb24pIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRFeGVjdXRpb24odG9BY3Rpb25FeGVjdXRpb24odGhpcy5leGVjdXRpb24pKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3RhcnRTdWJDaGFpbikge1xuICAgICAgcGJBY3Rpb25Db3JlLnNldFN0YXJ0c3ViY2hhaW4odG9BY3Rpb25TdGFydFN1YkNoYWluKHRoaXMuc3RhcnRTdWJDaGFpbikpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5zdG9wU3ViQ2hhaW4pIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRTdG9wc3ViY2hhaW4odG9BY3Rpb25TdG9wU3ViQ2hhaW4odGhpcy5zdG9wU3ViQ2hhaW4pKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucHV0QmxvY2spIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRQdXRibG9jayh0b0FjdGlvblB1dEJsb2NrKHRoaXMucHV0QmxvY2spKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuY3JlYXRlRGVwb3NpdCkge1xuICAgICAgcGJBY3Rpb25Db3JlLnNldENyZWF0ZWRlcG9zaXQodG9BY3Rpb25DcmVhdGVEZXBvc2l0KHRoaXMuY3JlYXRlRGVwb3NpdCkpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5zZXR0bGVEZXBvc2l0KSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0U2V0dGxlZGVwb3NpdCh0b0FjdGlvblNldHRsZURlcG9zaXQodGhpcy5zZXR0bGVEZXBvc2l0KSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNyZWF0ZVBsdW1DaGFpbikge1xuICAgICAgcGJBY3Rpb25Db3JlLnNldENyZWF0ZXBsdW1jaGFpbihcbiAgICAgICAgdG9BY3Rpb25DcmVhdGVQbHVtQ2hhaW4odGhpcy5jcmVhdGVQbHVtQ2hhaW4pXG4gICAgICApO1xuICAgIH0gZWxzZSBpZiAodGhpcy50ZXJtaW5hdGVQbHVtQ2hhaW4pIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRUZXJtaW5hdGVwbHVtY2hhaW4oXG4gICAgICAgIHRvQWN0aW9uVGVybWluYXRlUGx1bUNoYWluKHRoaXMudGVybWluYXRlUGx1bUNoYWluKVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucGx1bVB1dEJsb2NrKSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0UGx1bXB1dGJsb2NrKHRvQWN0aW9uUGx1bVB1dEJsb2NrKHRoaXMucGx1bVB1dEJsb2NrKSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnBsdW1DcmVhdGVEZXBvc2l0KSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0UGx1bWNyZWF0ZWRlcG9zaXQoXG4gICAgICAgIHRvQWN0aW9uUGx1bUNyZWF0ZURlcG9zaXQodGhpcy5wbHVtQ3JlYXRlRGVwb3NpdClcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnBsdW1TdGFydEV4aXQpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRQbHVtc3RhcnRleGl0KHRvQWN0aW9uUGx1bVN0YXJ0RXhpdCh0aGlzLnBsdW1TdGFydEV4aXQpKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucGx1bUNoYWxsZW5nZUV4aXQpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRQbHVtY2hhbGxlbmdlZXhpdChcbiAgICAgICAgdG9BY3Rpb25QbHVtQ2hhbGxlbmdlRXhpdCh0aGlzLnBsdW1DaGFsbGVuZ2VFeGl0KVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMucGx1bVJlc3BvbnNlQ2hhbGxlbmdlRXhpdCkge1xuICAgICAgcGJBY3Rpb25Db3JlLnNldFBsdW1yZXNwb25zZWNoYWxsZW5nZWV4aXQoXG4gICAgICAgIHRvQWN0aW9uUGx1bVJlc3BvbnNlQ2hhbGxlbmdlRXhpdCh0aGlzLnBsdW1SZXNwb25zZUNoYWxsZW5nZUV4aXQpXG4gICAgICApO1xuICAgIH0gZWxzZSBpZiAodGhpcy5wbHVtRmluYWxpemVFeGl0KSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0UGx1bWZpbmFsaXplZXhpdChcbiAgICAgICAgdG9BY3Rpb25QbHVtRmluYWxpemVFeGl0KHRoaXMucGx1bUZpbmFsaXplRXhpdClcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnBsdW1TZXR0bGVEZXBvc2l0KSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0UGx1bXNldHRsZWRlcG9zaXQoXG4gICAgICAgIHRvQWN0aW9uUGx1bVNldHRsZURlcG9zaXQodGhpcy5wbHVtU2V0dGxlRGVwb3NpdClcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnBsdW1UcmFuc2Zlcikge1xuICAgICAgcGJBY3Rpb25Db3JlLnNldFBsdW10cmFuc2Zlcih0b0FjdGlvblBsdW1UcmFuc2Zlcih0aGlzLnBsdW1UcmFuc2ZlcikpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5kZXBvc2l0VG9SZXdhcmRpbmdGdW5kKSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0RGVwb3NpdHRvcmV3YXJkaW5nZnVuZChcbiAgICAgICAgdG9BY3Rpb25EZXBvc2l0VG9SZXdhcmRpbmdGdW5kKHRoaXMuZGVwb3NpdFRvUmV3YXJkaW5nRnVuZClcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNsYWltRnJvbVJld2FyZGluZ0Z1bmQpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRDbGFpbWZyb21yZXdhcmRpbmdmdW5kKFxuICAgICAgICB0b0FjdGlvbkNsYWltRnJvbVJld2FyZGluZ0Z1bmQodGhpcy5jbGFpbUZyb21SZXdhcmRpbmdGdW5kKVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuZ3JhbnRSZXdhcmQpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRHcmFudHJld2FyZCh0b0FjdGlvbkdyYW50UmV3YXJkKHRoaXMuZ3JhbnRSZXdhcmQpKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3Rha2VDcmVhdGUpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRTdGFrZWNyZWF0ZSh0b0FjdGlvblN0YWtlQ3JlYXRlKHRoaXMuc3Rha2VDcmVhdGUpKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3Rha2VVbnN0YWtlKSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0U3Rha2V1bnN0YWtlKHRvQWN0aW9uU3Rha2VSZWNsYWltKHRoaXMuc3Rha2VVbnN0YWtlKSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnN0YWtlV2l0aGRyYXcpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRTdGFrZXdpdGhkcmF3KHRvQWN0aW9uU3Rha2VSZWNsYWltKHRoaXMuc3Rha2VXaXRoZHJhdykpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5zdGFrZUFkZERlcG9zaXQpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRTdGFrZWFkZGRlcG9zaXQoXG4gICAgICAgIHRvQWN0aW9uU3Rha2VBZGREZXBvc2l0KHRoaXMuc3Rha2VBZGREZXBvc2l0KVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3Rha2VSZXN0YWtlKSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0U3Rha2VyZXN0YWtlKHRvQWN0aW9uU3Rha2VSZXN0YWtlKHRoaXMuc3Rha2VSZXN0YWtlKSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnN0YWtlQ2hhbmdlQ2FuZGlkYXRlKSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0U3Rha2VjaGFuZ2VjYW5kaWRhdGUoXG4gICAgICAgIHRvQWN0aW9uU3Rha2VDaGFuZ2VDYW5kaWRhdGUodGhpcy5zdGFrZUNoYW5nZUNhbmRpZGF0ZSlcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnN0YWtlVHJhbnNmZXJPd25lcnNoaXApIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRTdGFrZXRyYW5zZmVyb3duZXJzaGlwKFxuICAgICAgICB0b0FjdGlvblN0YWtlVHJhbnNmZXJPd25lcnNoaXAodGhpcy5zdGFrZVRyYW5zZmVyT3duZXJzaGlwKVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuY2FuZGlkYXRlUmVnaXN0ZXIpIHtcbiAgICAgIHBiQWN0aW9uQ29yZS5zZXRDYW5kaWRhdGVyZWdpc3RlcihcbiAgICAgICAgdG9BY3Rpb25DYW5kaWRhdGVSZWdpc3Rlcih0aGlzLmNhbmRpZGF0ZVJlZ2lzdGVyKVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuY2FuZGlkYXRlVXBkYXRlKSB7XG4gICAgICBwYkFjdGlvbkNvcmUuc2V0Q2FuZGlkYXRldXBkYXRlKFxuICAgICAgICB0b0FjdGlvbkNhbmRpZGF0ZUJhc2ljSW5mbyh0aGlzLmNhbmRpZGF0ZVVwZGF0ZSlcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBwYkFjdGlvbkNvcmU7XG4gIH1cblxuICBwdWJsaWMgYnl0ZXN0cmVhbSgpOiBVaW50OEFycmF5IHtcbiAgICByZXR1cm4gdGhpcy5jb3JlKCkuc2VyaWFsaXplQmluYXJ5KCk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIGRlc2VyaWFsaXplKGJ5dGVzOiBVaW50OEFycmF5KTogRW52ZWxvcCB7XG4gICAgY29uc3QgcGJBY3Rpb25Db3JlID0gYWN0aW9uUGIuQWN0aW9uQ29yZS5kZXNlcmlhbGl6ZUJpbmFyeShieXRlcyk7XG4gICAgY29uc3QgZW52ZWxvcCA9IG5ldyBFbnZlbG9wKFxuICAgICAgcGJBY3Rpb25Db3JlLmdldFZlcnNpb24oKSxcbiAgICAgIFN0cmluZyhwYkFjdGlvbkNvcmUuZ2V0Tm9uY2UoKSksXG4gICAgICBTdHJpbmcocGJBY3Rpb25Db3JlLmdldEdhc2xpbWl0KCkpLFxuICAgICAgcGJBY3Rpb25Db3JlLmdldEdhc3ByaWNlKClcbiAgICApO1xuICAgIGVudmVsb3AudHJhbnNmZXIgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tVHJhbnNmZXIoXG4gICAgICBwYkFjdGlvbkNvcmUuZ2V0VHJhbnNmZXIoKVxuICAgICk7XG4gICAgZW52ZWxvcC5leGVjdXRpb24gPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tRXhlY3V0aW9uKFxuICAgICAgcGJBY3Rpb25Db3JlLmdldEV4ZWN1dGlvbigpXG4gICAgKTtcbiAgICBlbnZlbG9wLmNsYWltRnJvbVJld2FyZGluZ0Z1bmQgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tQ2xhaW1Gcm9tUmV3YXJkaW5nRnVuZChcbiAgICAgIHBiQWN0aW9uQ29yZS5nZXRDbGFpbWZyb21yZXdhcmRpbmdmdW5kKClcbiAgICApO1xuICAgIGVudmVsb3Auc3Rha2VDcmVhdGUgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tU3Rha2VDcmVhdGUoXG4gICAgICBwYkFjdGlvbkNvcmUuZ2V0U3Rha2VjcmVhdGUoKVxuICAgICk7XG4gICAgZW52ZWxvcC5zdGFrZVVuc3Rha2UgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tU3Rha2VSZWNsYWltKFxuICAgICAgcGJBY3Rpb25Db3JlLmdldFN0YWtldW5zdGFrZSgpXG4gICAgKTtcbiAgICBlbnZlbG9wLnN0YWtlV2l0aGRyYXcgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tU3Rha2VSZWNsYWltKFxuICAgICAgcGJBY3Rpb25Db3JlLmdldFN0YWtld2l0aGRyYXcoKVxuICAgICk7XG4gICAgZW52ZWxvcC5zdGFrZUFkZERlcG9zaXQgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tU3Rha2VBZGREZXBvc2l0KFxuICAgICAgcGJBY3Rpb25Db3JlLmdldFN0YWtlYWRkZGVwb3NpdCgpXG4gICAgKTtcbiAgICBlbnZlbG9wLnN0YWtlUmVzdGFrZSA9IEdldEFjdGlvbnNSZXF1ZXN0LmZyb21TdGFrZVJlc3Rha2UoXG4gICAgICBwYkFjdGlvbkNvcmUuZ2V0U3Rha2VyZXN0YWtlKClcbiAgICApO1xuICAgIGVudmVsb3Auc3Rha2VDaGFuZ2VDYW5kaWRhdGUgPSBHZXRBY3Rpb25zUmVxdWVzdC5mcm9tU3Rha2VDaGFuZ2VDYW5kaWRhdGUoXG4gICAgICBwYkFjdGlvbkNvcmUuZ2V0U3Rha2VjaGFuZ2VjYW5kaWRhdGUoKVxuICAgICk7XG4gICAgZW52ZWxvcC5zdGFrZVRyYW5zZmVyT3duZXJzaGlwID0gR2V0QWN0aW9uc1JlcXVlc3QuZnJvbVN0YWtlVHJhbnNmZXJPd25lcnNoaXAoXG4gICAgICBwYkFjdGlvbkNvcmUuZ2V0U3Rha2V0cmFuc2Zlcm93bmVyc2hpcCgpXG4gICAgKTtcbiAgICBlbnZlbG9wLmNhbmRpZGF0ZVJlZ2lzdGVyID0gR2V0QWN0aW9uc1JlcXVlc3QuZnJvbUNhbmRpZGF0ZVJlZ2lzdGVyKFxuICAgICAgcGJBY3Rpb25Db3JlLmdldENhbmRpZGF0ZXJlZ2lzdGVyKClcbiAgICApO1xuICAgIGVudmVsb3AuY2FuZGlkYXRlVXBkYXRlID0gR2V0QWN0aW9uc1JlcXVlc3QuZnJvbUNhbmRpZGF0ZVVwZGF0ZShcbiAgICAgIHBiQWN0aW9uQ29yZS5nZXRDYW5kaWRhdGV1cGRhdGUoKVxuICAgICk7XG4gICAgLy8gVE9ETyh0aWFuKTogYWRkIG1vcmUgZmllbGRzXG4gICAgcmV0dXJuIGVudmVsb3A7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFNlYWxlZEVudmVsb3Age1xuICBwdWJsaWMgYWN0OiBFbnZlbG9wO1xuICBwdWJsaWMgc2VuZGVyUHViS2V5OiBCdWZmZXI7XG4gIHB1YmxpYyBzaWduYXR1cmU6IEJ1ZmZlcjtcblxuICBjb25zdHJ1Y3RvcihhY3Q6IEVudmVsb3AsIHNlbmRlclB1YktleTogQnVmZmVyLCBzaWduYXR1cmU6IEJ1ZmZlcikge1xuICAgIHRoaXMuYWN0ID0gYWN0O1xuICAgIHRoaXMuc2VuZGVyUHViS2V5ID0gc2VuZGVyUHViS2V5O1xuICAgIHRoaXMuc2lnbmF0dXJlID0gc2lnbmF0dXJlO1xuICB9XG5cbiAgcHVibGljIGJ5dGVzdHJlYW0oKTogVWludDhBcnJheSB7XG4gICAgY29uc3QgcGJBY3Rpb25Db3JlID0gdGhpcy5hY3QuY29yZSgpO1xuICAgIGNvbnN0IHBiQWN0aW9uID0gbmV3IGFjdGlvblBiLkFjdGlvbigpO1xuICAgIHBiQWN0aW9uLnNldENvcmUocGJBY3Rpb25Db3JlKTtcbiAgICBwYkFjdGlvbi5zZXRTZW5kZXJwdWJrZXkodGhpcy5zZW5kZXJQdWJLZXkpO1xuICAgIHBiQWN0aW9uLnNldFNpZ25hdHVyZSh0aGlzLnNpZ25hdHVyZSk7XG4gICAgcmV0dXJuIHBiQWN0aW9uLnNlcmlhbGl6ZUJpbmFyeSgpO1xuICB9XG5cbiAgcHVibGljIGhhc2goKTogc3RyaW5nIHtcbiAgICByZXR1cm4gQnVmZmVyLmZyb20oaGFzaDI1NmIodGhpcy5ieXRlc3RyZWFtKCkpKS50b1N0cmluZyhcImhleFwiKTtcbiAgfVxuXG4gIHB1YmxpYyBhY3Rpb24oKTogSUFjdGlvbiB7XG4gICAgY29uc3QgZ2FzTGltaXQgPSB0aGlzLmFjdC5nYXNMaW1pdCB8fCBcIjBcIjtcbiAgICBjb25zdCBnYXNQcmljZSA9IHRoaXMuYWN0Lmdhc1ByaWNlIHx8IFwiMFwiO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGNvcmU6IHtcbiAgICAgICAgdmVyc2lvbjogdGhpcy5hY3QudmVyc2lvbixcbiAgICAgICAgbm9uY2U6IHRoaXMuYWN0Lm5vbmNlLFxuICAgICAgICBnYXNMaW1pdDogZ2FzTGltaXQsXG4gICAgICAgIGdhc1ByaWNlOiBnYXNQcmljZSxcbiAgICAgICAgdHJhbnNmZXI6IHRoaXMuYWN0LnRyYW5zZmVyLFxuICAgICAgICBleGVjdXRpb246IHRoaXMuYWN0LmV4ZWN1dGlvbixcbiAgICAgICAgc3RhcnRTdWJDaGFpbjogdGhpcy5hY3Quc3RhcnRTdWJDaGFpbixcbiAgICAgICAgc3RvcFN1YkNoYWluOiB0aGlzLmFjdC5zdG9wU3ViQ2hhaW4sXG4gICAgICAgIHB1dEJsb2NrOiB0aGlzLmFjdC5wdXRCbG9jayxcbiAgICAgICAgY3JlYXRlRGVwb3NpdDogdGhpcy5hY3QuY3JlYXRlRGVwb3NpdCxcbiAgICAgICAgc2V0dGxlRGVwb3NpdDogdGhpcy5hY3Quc2V0dGxlRGVwb3NpdCxcbiAgICAgICAgY3JlYXRlUGx1bUNoYWluOiB0aGlzLmFjdC5jcmVhdGVQbHVtQ2hhaW4sXG4gICAgICAgIHRlcm1pbmF0ZVBsdW1DaGFpbjogdGhpcy5hY3QudGVybWluYXRlUGx1bUNoYWluLFxuICAgICAgICBwbHVtUHV0QmxvY2s6IHRoaXMuYWN0LnBsdW1QdXRCbG9jayxcbiAgICAgICAgcGx1bUNyZWF0ZURlcG9zaXQ6IHRoaXMuYWN0LnBsdW1DcmVhdGVEZXBvc2l0LFxuICAgICAgICBwbHVtU3RhcnRFeGl0OiB0aGlzLmFjdC5wbHVtU3RhcnRFeGl0LFxuICAgICAgICBwbHVtQ2hhbGxlbmdlRXhpdDogdGhpcy5hY3QucGx1bUNoYWxsZW5nZUV4aXQsXG4gICAgICAgIHBsdW1SZXNwb25zZUNoYWxsZW5nZUV4aXQ6IHRoaXMuYWN0LnBsdW1SZXNwb25zZUNoYWxsZW5nZUV4aXQsXG4gICAgICAgIHBsdW1GaW5hbGl6ZUV4aXQ6IHRoaXMuYWN0LnBsdW1GaW5hbGl6ZUV4aXQsXG4gICAgICAgIHBsdW1TZXR0bGVEZXBvc2l0OiB0aGlzLmFjdC5wbHVtU2V0dGxlRGVwb3NpdCxcbiAgICAgICAgcGx1bVRyYW5zZmVyOiB0aGlzLmFjdC5wbHVtVHJhbnNmZXIsXG4gICAgICAgIGRlcG9zaXRUb1Jld2FyZGluZ0Z1bmQ6IHRoaXMuYWN0LmRlcG9zaXRUb1Jld2FyZGluZ0Z1bmQsXG4gICAgICAgIGNsYWltRnJvbVJld2FyZGluZ0Z1bmQ6IHRoaXMuYWN0LmNsYWltRnJvbVJld2FyZGluZ0Z1bmQsXG4gICAgICAgIGdyYW50UmV3YXJkOiB0aGlzLmFjdC5ncmFudFJld2FyZCxcbiAgICAgICAgc3Rha2VDcmVhdGU6IHRoaXMuYWN0LnN0YWtlQ3JlYXRlLFxuICAgICAgICBzdGFrZVVuc3Rha2U6IHRoaXMuYWN0LnN0YWtlVW5zdGFrZSxcbiAgICAgICAgc3Rha2VXaXRoZHJhdzogdGhpcy5hY3Quc3Rha2VXaXRoZHJhdyxcbiAgICAgICAgc3Rha2VBZGREZXBvc2l0OiB0aGlzLmFjdC5zdGFrZUFkZERlcG9zaXQsXG4gICAgICAgIHN0YWtlUmVzdGFrZTogdGhpcy5hY3Quc3Rha2VSZXN0YWtlLFxuICAgICAgICBzdGFrZUNoYW5nZUNhbmRpZGF0ZTogdGhpcy5hY3Quc3Rha2VDaGFuZ2VDYW5kaWRhdGUsXG4gICAgICAgIHN0YWtlVHJhbnNmZXJPd25lcnNoaXA6IHRoaXMuYWN0LnN0YWtlVHJhbnNmZXJPd25lcnNoaXAsXG4gICAgICAgIGNhbmRpZGF0ZVJlZ2lzdGVyOiB0aGlzLmFjdC5jYW5kaWRhdGVSZWdpc3RlcixcbiAgICAgICAgY2FuZGlkYXRlVXBkYXRlOiB0aGlzLmFjdC5jYW5kaWRhdGVVcGRhdGUsXG4gICAgICAgIHB1dFBvbGxSZXN1bHQ6IHRoaXMuYWN0LnB1dFBvbGxSZXN1bHRcbiAgICAgIH0sXG4gICAgICBzZW5kZXJQdWJLZXk6IHRoaXMuc2VuZGVyUHViS2V5LFxuICAgICAgc2lnbmF0dXJlOiB0aGlzLnNpZ25hdHVyZVxuICAgIH07XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIHNpZ24oXG4gICAgcHJpdmF0ZUtleTogc3RyaW5nLFxuICAgIHB1YmxpY0tleTogc3RyaW5nLFxuICAgIGFjdDogRW52ZWxvcFxuICApOiBTZWFsZWRFbnZlbG9wIHtcbiAgICBjb25zdCBoID0gaGFzaDI1NmIoYWN0LmJ5dGVzdHJlYW0oKSk7XG4gICAgY29uc3Qgc2lnbiA9IEJ1ZmZlci5mcm9tKFxuICAgICAgbWFrZVNpZ25lcigwKShoLnRvU3RyaW5nKFwiaGV4XCIpLCBwcml2YXRlS2V5KSxcbiAgICAgIFwiaGV4XCJcbiAgICApO1xuICAgIHJldHVybiBuZXcgU2VhbGVkRW52ZWxvcChhY3QsIEJ1ZmZlci5mcm9tKHB1YmxpY0tleSwgXCJoZXhcIiksIHNpZ24pO1xuICB9XG59XG4iXX0=